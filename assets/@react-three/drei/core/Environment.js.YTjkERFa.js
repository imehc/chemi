import{_ as G}from"../../../@babel/runtime/helpers/esm/extends.js.dGVwEr9R.js";import{r as n}from"../../../react/index.js.4247Uq6c.js";import{d as L,e as M,H as C}from"../../../three/build/three.module.js.ZP5wlr6b.js";import{G as I}from"../../../three-stdlib/objects/GroundProjectedEnv.js.VMS1s5Aq.js";import{u as _}from"./useEnvironment.js.CLsVo-HZ.js";import{u as f,a as R,c as T,e as $}from"../../fiber/dist/index-db8af450.esm.js.eaJ-IQWK.js";const j=e=>e.current&&e.current.isScene,k=e=>j(e)?e.current:e;function h(e,o,a,r,u=0){const t=k(o||a),c=t.background,i=t.environment,l=t.backgroundBlurriness||0;return e!=="only"&&(t.environment=r),e&&(t.background=r),e&&t.backgroundBlurriness!==void 0&&(t.backgroundBlurriness=u),()=>{e!=="only"&&(t.environment=i),e&&(t.background=c),e&&t.backgroundBlurriness!==void 0&&(t.backgroundBlurriness=l)}}function y({scene:e,background:o=!1,blur:a,map:r}){const u=f(t=>t.scene);return n.useLayoutEffect(()=>{if(r)return h(o,e,u,r,a)},[u,e,r,o,a]),null}function F({background:e=!1,scene:o,blur:a,...r}){const u=_(r),t=f(c=>c.scene);return n.useLayoutEffect(()=>h(e,o,t,u,a),[u,e,o,t,a]),null}function p({children:e,near:o=1,far:a=1e3,resolution:r=256,frames:u=1,map:t,background:c=!1,blur:i,scene:l,files:m,path:E,preset:S=void 0,extensions:b}){const g=f(s=>s.gl),B=f(s=>s.scene),v=n.useRef(null),[d]=n.useState(()=>new L),x=n.useMemo(()=>{const s=new M(r);return s.texture.type=C,s},[r]);n.useLayoutEffect(()=>(u===1&&v.current.update(g,d),h(c,l,B,x.texture,i)),[e,d,x.texture,l,B,c,u,g]);let P=1;return R(()=>{(u===1/0||P<u)&&(v.current.update(g,d),P++)}),n.createElement(n.Fragment,null,T(n.createElement(n.Fragment,null,e,n.createElement("cubeCamera",{ref:v,args:[o,a,x]}),m||S?n.createElement(F,{background:!0,files:m,preset:S,path:E,extensions:b}):t?n.createElement(y,{background:!0,map:t,extensions:b}):null),d))}function w(e){var o,a,r,u;const t=_(e),c=e.map||t;n.useMemo(()=>$({GroundProjectedEnvImpl:I}),[]);const i=n.useMemo(()=>[c],[c]),l=(o=e.ground)==null?void 0:o.height,m=(a=e.ground)==null?void 0:a.radius,E=(r=(u=e.ground)==null?void 0:u.scale)!==null&&r!==void 0?r:1e3;return n.createElement(n.Fragment,null,n.createElement(y,G({},e,{map:c})),n.createElement("groundProjectedEnvImpl",{args:i,scale:E,height:l,radius:m}))}function J(e){return e.ground?n.createElement(w,e):e.map?n.createElement(y,e):e.children?n.createElement(p,e):n.createElement(F,e)}export{J as E};
//# sourceMappingURL=Environment.js.YTjkERFa.js.map

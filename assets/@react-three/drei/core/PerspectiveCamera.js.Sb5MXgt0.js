import{_ as y}from"../../../@babel/runtime/helpers/esm/extends.js.dGVwEr9R.js";import{r}from"../../../react/index.js.4247Uq6c.js";import{m as x}from"../../../react-merge-refs/dist/react-merge-refs.esm.js.hAbx5P3g.js";import{u as v}from"./useFBO.js.ISviHxA8.js";import{u as i,a as F}from"../../fiber/dist/index-db8af450.esm.js.eaJ-IQWK.js";const C=n=>typeof n=="function",w=r.forwardRef(({envMap:n,resolution:E=256,frames:m=1/0,makeDefault:l,children:c,...o},R)=>{const u=i(({set:e})=>e),b=i(({camera:e})=>e),a=i(({size:e})=>e),t=r.useRef(null),s=r.useRef(null),g=v(E);r.useLayoutEffect(()=>{o.manual||(t.current.aspect=a.width/a.height)},[a,o]),r.useLayoutEffect(()=>{t.current.updateProjectionMatrix()});let p=0,d=null;const f=C(c);return F(e=>{f&&(m===1/0||p<m)&&(s.current.visible=!1,e.gl.setRenderTarget(g),d=e.scene.background,n&&(e.scene.background=n),e.gl.render(e.scene,t.current),e.scene.background=d,e.gl.setRenderTarget(null),s.current.visible=!0,p++)}),r.useLayoutEffect(()=>{if(l){const e=b;return u(()=>({camera:t.current})),()=>u(()=>({camera:e}))}},[t,l,u]),r.createElement(r.Fragment,null,r.createElement("perspectiveCamera",y({ref:x([t,R])},o),!f&&c),r.createElement("group",{ref:s},f&&c(g.texture)))});export{w as P};
//# sourceMappingURL=PerspectiveCamera.js.Sb5MXgt0.js.map

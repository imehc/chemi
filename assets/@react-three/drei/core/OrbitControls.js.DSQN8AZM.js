import{_ as F}from"../../../@babel/runtime/helpers/esm/extends.js.CF3RwP-h.js";import{r}from"../../../react/index.js.IuPGg7Py.js";import{O as M}from"../../../three-stdlib/controls/OrbitControls.js.DqJlVqcH.js";import{u as n,a as R}from"../../fiber/dist/index-ba8afaa4.esm.js.CC8UC62r.js";const A=r.forwardRef(({makeDefault:l,camera:b,regress:d,domElement:L,enableDamping:g=!0,keyEvents:o=!1,onChange:c,onStart:a,onEnd:i,...x},C)=>{const m=n(e=>e.invalidate),O=n(e=>e.camera),w=n(e=>e.gl),_=n(e=>e.events),h=n(e=>e.setEvents),p=n(e=>e.set),j=n(e=>e.get),D=n(e=>e.performance),u=b||O,f=L||_.connected||w.domElement,t=r.useMemo(()=>new M(u),[u]);return R(()=>{t.enabled&&t.update()},-1),r.useEffect(()=>(o&&t.connect(o===!0?f:o),t.connect(f),()=>void t.dispose()),[o,f,d,t,m]),r.useEffect(()=>{const e=s=>{m(),d&&D.regress(),c&&c(s)},v=s=>{a&&a(s)},E=s=>{i&&i(s)};return t.addEventListener("change",e),t.addEventListener("start",v),t.addEventListener("end",E),()=>{t.removeEventListener("start",v),t.removeEventListener("end",E),t.removeEventListener("change",e)}},[c,a,i,t,m,h]),r.useEffect(()=>{if(l){const e=j().controls;return p({controls:t}),()=>p({controls:e})}},[l,t]),r.createElement("primitive",F({ref:C,object:t,enableDamping:g},x))});export{A as O};

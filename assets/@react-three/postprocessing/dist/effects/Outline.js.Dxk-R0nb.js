import{j as y}from"../../../../react/jsx-runtime.js.CKQaLlsx.js";import{O as M}from"../../../../postprocessing/build/index.js.BeBDb62p.js";import{r as t}from"../../../../react/index.js.CiILtb88.js";import{E as _}from"../EffectComposer.js.DG2t1AjR.js";import{s as d}from"../Selection.js.2dB2Wz08.js";import{r as R}from"../util.js.fRkg8jUg.js";import{u as q}from"../../../fiber/dist/index-c636ef6d.esm.js.DtZMtc8k.js";const N=t.forwardRef(function({selection:o=[],selectionLayer:a=10,blendFunction:c,patternTexture:i,edgeStrength:n,pulseSpeed:m,visibleEdgeColor:u,hiddenEdgeColor:p,width:l,height:x,kernelSize:E,blur:v,xRay:O,...A},w){const s=q(f=>f.invalidate),{scene:j,camera:C}=t.useContext(_),e=t.useMemo(()=>new M(j,C,{blendFunction:c,patternTexture:i,edgeStrength:n,pulseSpeed:m,visibleEdgeColor:u,hiddenEdgeColor:p,width:l,height:x,kernelSize:E,blur:v,xRay:O,...A}),[c,v,C,n,x,p,E,i,m,j,u,l,O]),r=t.useContext(d);return t.useEffect(()=>{if(!r&&o)return e.selection.set(Array.isArray(o)?o.map(R):[R(o)]),s(),()=>{e.selection.clear(),s()}},[e,o,r,s]),t.useEffect(()=>{e.selectionLayer=a,s()},[e,s,a]),t.useRef(),t.useEffect(()=>{var f;if(r&&r.enabled&&(f=r.selected)!=null&&f.length)return e.selection.set(r.selected),s(),()=>{e.selection.clear(),s()}},[r,e.selection,s]),t.useEffect(()=>()=>{e.dispose()},[e]),y.jsx("primitive",{ref:w,object:e})});export{N as O};

{"version":3,"file":"react-three-fiber.esm.js.js0O8qBn.js","sources":["../../../../../node_modules/.pnpm/@react-three+fiber@8.15.11_react-dom@18.2.0_react@18.2.0_three@0.158.0/node_modules/@react-three/fiber/dist/react-three-fiber.esm.js"],"sourcesContent":["import { c as createEvents, e as extend, u as useMutableCallback, a as useIsomorphicLayoutEffect, b as createRoot, i as isRef, E as ErrorBoundary, B as Block, d as unmountComponentAtNode } from './index-db8af450.esm.js';\nexport { t as ReactThreeFiber, x as _roots, v as act, o as addAfterEffect, n as addEffect, p as addTail, m as advance, j as applyProps, w as buildGraph, f as context, c as createEvents, g as createPortal, b as createRoot, k as dispose, e as extend, q as flushGlobalEffects, s as getRootState, l as invalidate, h as reconciler, r as render, d as unmountComponentAtNode, C as useFrame, D as useGraph, y as useInstanceHandle, F as useLoader, z as useStore, A as useThree } from './index-db8af450.esm.js';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport useMeasure from 'react-use-measure';\nimport { FiberProvider, useContextBridge } from 'its-fine';\nimport 'react-reconciler/constants';\nimport 'zustand';\nimport 'react-reconciler';\nimport 'scheduler';\nimport 'suspend-react';\n\nconst DOM_EVENTS = {\n  onClick: ['click', false],\n  onContextMenu: ['contextmenu', false],\n  onDoubleClick: ['dblclick', false],\n  onWheel: ['wheel', true],\n  onPointerDown: ['pointerdown', true],\n  onPointerUp: ['pointerup', true],\n  onPointerLeave: ['pointerleave', true],\n  onPointerMove: ['pointermove', true],\n  onPointerCancel: ['pointercancel', true],\n  onLostPointerCapture: ['lostpointercapture', true]\n};\n\n/** Default R3F event manager for web */\nfunction createPointerEvents(store) {\n  const {\n    handlePointer\n  } = createEvents(store);\n  return {\n    priority: 1,\n    enabled: true,\n    compute(event, state, previous) {\n      // https://github.com/pmndrs/react-three-fiber/pull/782\n      // Events trigger outside of canvas when moved, use offsetX/Y by default and allow overrides\n      state.pointer.set(event.offsetX / state.size.width * 2 - 1, -(event.offsetY / state.size.height) * 2 + 1);\n      state.raycaster.setFromCamera(state.pointer, state.camera);\n    },\n    connected: undefined,\n    handlers: Object.keys(DOM_EVENTS).reduce((acc, key) => ({\n      ...acc,\n      [key]: handlePointer(key)\n    }), {}),\n    update: () => {\n      var _internal$lastEvent;\n      const {\n        events,\n        internal\n      } = store.getState();\n      if ((_internal$lastEvent = internal.lastEvent) != null && _internal$lastEvent.current && events.handlers) events.handlers.onPointerMove(internal.lastEvent.current);\n    },\n    connect: target => {\n      var _events$handlers;\n      const {\n        set,\n        events\n      } = store.getState();\n      events.disconnect == null ? void 0 : events.disconnect();\n      set(state => ({\n        events: {\n          ...state.events,\n          connected: target\n        }\n      }));\n      Object.entries((_events$handlers = events.handlers) != null ? _events$handlers : []).forEach(([name, event]) => {\n        const [eventName, passive] = DOM_EVENTS[name];\n        target.addEventListener(eventName, event, {\n          passive\n        });\n      });\n    },\n    disconnect: () => {\n      const {\n        set,\n        events\n      } = store.getState();\n      if (events.connected) {\n        var _events$handlers2;\n        Object.entries((_events$handlers2 = events.handlers) != null ? _events$handlers2 : []).forEach(([name, event]) => {\n          if (events && events.connected instanceof HTMLElement) {\n            const [eventName] = DOM_EVENTS[name];\n            events.connected.removeEventListener(eventName, event);\n          }\n        });\n        set(state => ({\n          events: {\n            ...state.events,\n            connected: undefined\n          }\n        }));\n      }\n    }\n  };\n}\n\nconst CanvasImpl = /*#__PURE__*/React.forwardRef(function Canvas({\n  children,\n  fallback,\n  resize,\n  style,\n  gl,\n  events = createPointerEvents,\n  eventSource,\n  eventPrefix,\n  shadows,\n  linear,\n  flat,\n  legacy,\n  orthographic,\n  frameloop,\n  dpr,\n  performance,\n  raycaster,\n  camera,\n  scene,\n  onPointerMissed,\n  onCreated,\n  ...props\n}, forwardedRef) {\n  // Create a known catalogue of Threejs-native elements\n  // This will include the entire THREE namespace by default, users can extend\n  // their own elements by using the createRoot API instead\n  React.useMemo(() => extend(THREE), []);\n  const Bridge = useContextBridge();\n  const [containerRef, containerRect] = useMeasure({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    },\n    ...resize\n  });\n  const canvasRef = React.useRef(null);\n  const divRef = React.useRef(null);\n  React.useImperativeHandle(forwardedRef, () => canvasRef.current);\n  const handlePointerMissed = useMutableCallback(onPointerMissed);\n  const [block, setBlock] = React.useState(false);\n  const [error, setError] = React.useState(false);\n\n  // Suspend this component if block is a promise (2nd run)\n  if (block) throw block;\n  // Throw exception outwards if anything within canvas throws\n  if (error) throw error;\n  const root = React.useRef(null);\n  useIsomorphicLayoutEffect(() => {\n    const canvas = canvasRef.current;\n    if (containerRect.width > 0 && containerRect.height > 0 && canvas) {\n      if (!root.current) root.current = createRoot(canvas);\n      root.current.configure({\n        gl,\n        events,\n        shadows,\n        linear,\n        flat,\n        legacy,\n        orthographic,\n        frameloop,\n        dpr,\n        performance,\n        raycaster,\n        camera,\n        scene,\n        size: containerRect,\n        // Pass mutable reference to onPointerMissed so it's free to update\n        onPointerMissed: (...args) => handlePointerMissed.current == null ? void 0 : handlePointerMissed.current(...args),\n        onCreated: state => {\n          // Connect to event source\n          state.events.connect == null ? void 0 : state.events.connect(eventSource ? isRef(eventSource) ? eventSource.current : eventSource : divRef.current);\n          // Set up compute function\n          if (eventPrefix) {\n            state.setEvents({\n              compute: (event, state) => {\n                const x = event[eventPrefix + 'X'];\n                const y = event[eventPrefix + 'Y'];\n                state.pointer.set(x / state.size.width * 2 - 1, -(y / state.size.height) * 2 + 1);\n                state.raycaster.setFromCamera(state.pointer, state.camera);\n              }\n            });\n          }\n          // Call onCreated callback\n          onCreated == null ? void 0 : onCreated(state);\n        }\n      });\n      root.current.render( /*#__PURE__*/React.createElement(Bridge, null, /*#__PURE__*/React.createElement(ErrorBoundary, {\n        set: setError\n      }, /*#__PURE__*/React.createElement(React.Suspense, {\n        fallback: /*#__PURE__*/React.createElement(Block, {\n          set: setBlock\n        })\n      }, children))));\n    }\n  });\n  React.useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) return () => unmountComponentAtNode(canvas);\n  }, []);\n\n  // When the event source is not this div, we need to set pointer-events to none\n  // Or else the canvas will block events from reaching the event source\n  const pointerEvents = eventSource ? 'none' : 'auto';\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: divRef,\n    style: {\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n      pointerEvents,\n      ...style\n    }\n  }, props), /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      display: 'block'\n    }\n  }, fallback)));\n});\n\n/**\r\n * A DOM canvas which accepts threejs elements as children.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/canvas\r\n */\nconst Canvas = /*#__PURE__*/React.forwardRef(function CanvasWrapper(props, ref) {\n  return /*#__PURE__*/React.createElement(FiberProvider, null, /*#__PURE__*/React.createElement(CanvasImpl, _extends({}, props, {\n    ref: ref\n  })));\n});\n\nexport { Canvas, createPointerEvents as events };\n"],"names":["DOM_EVENTS","createPointerEvents","store","handlePointer","createEvents","event","state","previous","acc","key","_internal$lastEvent","events","internal","target","_events$handlers","set","name","eventName","passive","_events$handlers2","CanvasImpl","React.forwardRef","children","fallback","resize","style","gl","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated","props","forwardedRef","React.useMemo","extend","THREE","Bridge","useContextBridge","containerRef","containerRect","useMeasure","canvasRef","React.useRef","divRef","React.useImperativeHandle","handlePointerMissed","useMutableCallback","block","setBlock","React.useState","error","setError","root","useIsomorphicLayoutEffect","canvas","createRoot","args","isRef","x","y","React.createElement","ErrorBoundary","React.Suspense","Block","React.useEffect","unmountComponentAtNode","pointerEvents","_extends","Canvas","ref","FiberProvider"],"mappings":"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","x_google_ignoreList":[0]}
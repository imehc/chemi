import{e as U,g as V,h as $,i as q,j as G,E as J,B as K,k as Q,l as Z}from"./index-db8af450.esm.js.eaJ-IQWK.js";import{_ as y}from"../../../@babel/runtime/helpers/esm/extends.js.dGVwEr9R.js";import{r as n}from"../../../react/index.js.4247Uq6c.js";import{z as ee}from"../../../three/build/three.module.js.ZP5wlr6b.js";import{u as ne}from"../../../react-use-measure/dist/web.js.7oM1nbYC.js";import{F as te,u as re}from"../../../its-fine/dist/index.js.9iirpWVO.js";import"../../../react-reconciler/constants.js.tdY7ep42.js";import"../../../react-reconciler/index.js.tbOlkM-I.js";import"../../../scheduler/index.js.42U5Wdl4.js";const E={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function oe(i){const{handlePointer:u}=Z(i);return{priority:1,enabled:!0,compute(t,e,r){e.pointer.set(t.offsetX/e.size.width*2-1,-(t.offsetY/e.size.height)*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)},connected:void 0,handlers:Object.keys(E).reduce((t,e)=>({...t,[e]:u(e)}),{}),update:()=>{var t;const{events:e,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&e.handlers&&e.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var e;const{set:r,events:o}=i.getState();o.disconnect==null||o.disconnect(),r(c=>({events:{...c.events,connected:t}})),Object.entries((e=o.handlers)!=null?e:[]).forEach(([c,s])=>{const[d,p]=E[c];t.addEventListener(d,s,{passive:p})})},disconnect:()=>{const{set:t,events:e}=i.getState();if(e.connected){var r;Object.entries((r=e.handlers)!=null?r:[]).forEach(([o,c])=>{if(e&&e.connected instanceof HTMLElement){const[s]=E[o];e.connected.removeEventListener(s,c)}}),t(o=>({events:{...o.events,connected:void 0}}))}}}}const se=n.forwardRef(function({children:u,fallback:t,resize:e,style:r,gl:o,events:c=oe,eventSource:s,eventPrefix:d,shadows:p,linear:M,flat:P,legacy:z,orthographic:x,frameloop:B,dpr:L,performance:j,raycaster:F,camera:N,scene:O,onPointerMissed:_,onCreated:C,...D},H){n.useMemo(()=>U(ee),[]);const I=re(),[S,h]=ne({scroll:!0,debounce:{scroll:50,resize:0},...e}),m=n.useRef(null),b=n.useRef(null);n.useImperativeHandle(H,()=>m.current);const w=V(_),[R,T]=n.useState(!1),[g,W]=n.useState(!1);if(R)throw R;if(g)throw g;const v=n.useRef(null);$(()=>{const f=m.current;h.width>0&&h.height>0&&f&&(v.current||(v.current=q(f)),v.current.configure({gl:o,events:c,shadows:p,linear:M,flat:P,legacy:z,orthographic:x,frameloop:B,dpr:L,performance:j,raycaster:F,camera:N,scene:O,size:h,onPointerMissed:(...a)=>w.current==null?void 0:w.current(...a),onCreated:a=>{a.events.connect==null||a.events.connect(s?G(s)?s.current:s:b.current),d&&a.setEvents({compute:(k,l)=>{const Y=k[d+"X"],A=k[d+"Y"];l.pointer.set(Y/l.size.width*2-1,-(A/l.size.height)*2+1),l.raycaster.setFromCamera(l.pointer,l.camera)}}),C==null||C(a)}}),v.current.render(n.createElement(I,null,n.createElement(J,{set:W},n.createElement(n.Suspense,{fallback:n.createElement(K,{set:T})},u)))))}),n.useEffect(()=>{const f=m.current;if(f)return()=>Q(f)},[]);const X=s?"none":"auto";return n.createElement("div",y({ref:b,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...r}},D),n.createElement("div",{ref:S,style:{width:"100%",height:"100%"}},n.createElement("canvas",{ref:m,style:{display:"block"}},t)))}),pe=n.forwardRef(function(u,t){return n.createElement(te,null,n.createElement(se,y({},u,{ref:t})))});export{pe as C};
//# sourceMappingURL=react-three-fiber.esm.js.js0O8qBn.js.map

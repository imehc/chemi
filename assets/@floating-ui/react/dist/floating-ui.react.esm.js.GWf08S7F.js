import{u as M}from"../../react-dom/dist/floating-ui.react-dom.mjs.zZjPM-86.js";import{r as n,$}from"../../../react/index.js.4247Uq6c.js";import"../../../react-dom/index.js.CRFhJLVO.js";var b=typeof document<"u"?n.useLayoutEffect:n.useEffect;let d=!1,D=0;const S=()=>"floating-ui-"+D++;function O(){const[e,s]=n.useState(()=>d?S():void 0);return b(()=>{e==null&&s(S())},[]),n.useEffect(()=>{d||(d=!0)},[]),e}const A=$.useId,B=A||O;function P(){const e=new Map;return{emit(s,c){var u;(u=e.get(s))==null||u.forEach(r=>r(c))},on(s,c){e.set(s,[...e.get(s)||[],c])},off(s,c){var u;e.set(s,((u=e.get(s))==null?void 0:u.filter(r=>r!==c))||[])}}}const T=n.createContext(null),H=()=>n.useContext(T);function L(e){return(e==null?void 0:e.ownerDocument)||document}function V(e){return L(e).defaultView||window}function a(e){return e?e instanceof Element||e instanceof V(e).Element:!1}const W=$.useInsertionEffect,_=W||(e=>e());function j(e){const s=n.useRef(()=>{});return _(()=>{s.current=e}),n.useCallback(function(){for(var c=arguments.length,u=new Array(c),r=0;r<c;r++)u[r]=arguments[r];return s.current==null?void 0:s.current(...u)},[])}function z(e){var s;e===void 0&&(e={});const{open:c=!1,onOpenChange:u,nodeId:r}=e,[h,F]=n.useState(null),g=((s=e.elements)==null?void 0:s.reference)||h,o=M(e),R=H(),E=j((t,f)=>{t&&(v.current.openEvent=f),u==null||u(t,f)}),p=n.useRef(null),v=n.useRef({}),C=n.useState(()=>P())[0],I=B(),x=n.useCallback(t=>{const f=a(t)?{getBoundingClientRect:()=>t.getBoundingClientRect(),contextElement:t}:t;o.refs.setReference(f)},[o.refs]),w=n.useCallback(t=>{(a(t)||t===null)&&(p.current=t,F(t)),(a(o.refs.reference.current)||o.refs.reference.current===null||t!==null&&!a(t))&&o.refs.setReference(t)},[o.refs]),i=n.useMemo(()=>({...o.refs,setReference:w,setPositionReference:x,domReference:p}),[o.refs,w,x]),l=n.useMemo(()=>({...o.elements,domReference:g}),[o.elements,g]),m=n.useMemo(()=>({...o,refs:i,elements:l,dataRef:v,nodeId:r,floatingId:I,events:C,open:c,onOpenChange:E}),[o,r,I,C,c,E,i,l]);return b(()=>{const t=R==null?void 0:R.nodesRef.current.find(f=>f.id===r);t&&(t.context=m)}),n.useMemo(()=>({...o,context:m,refs:i,elements:l}),[o,i,l,m])}export{z as u};
//# sourceMappingURL=floating-ui.react.esm.js.GWf08S7F.js.map

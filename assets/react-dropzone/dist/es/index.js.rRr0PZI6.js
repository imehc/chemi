import{r as l,R as Le}from"../../../react/index.js.4247Uq6c.js";import{P as i}from"../../../prop-types/index.js.FHdKJiuy.js";import{f as He}from"../../../file-selector/dist/es5/file-selector.js.zxg81M9y.js";import{c as Me,o as Ee,i as K,a as _e,f as Be,b as We,T as Ne,d as $e,e as Ue,g as qe,h as Je,j as y,k as Ye}from"./utils/index.js.XTYX4YEG.js";var Ge=["children"],Qe=["open"],Ve=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Xe=["refKey","onChange","onClick"];function Ze(e){return nr(e)||rr(e)||Pe(e)||er()}function er(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rr(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nr(e){if(Array.isArray(e))return oe(e)}function te(e,n){return ar(e)||or(e,n)||Pe(e,n)||tr()}function tr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pe(e,n){if(e){if(typeof e=="string")return oe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oe(e,n)}}function oe(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function or(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var a=[],u=!0,s=!1,b,v;try{for(t=t.call(e);!(u=(b=t.next()).done)&&(a.push(b.value),!(n&&a.length===n));u=!0);}catch(h){s=!0,v=h}finally{try{!u&&t.return!=null&&t.return()}finally{if(s)throw v}}return a}}function ar(e){if(Array.isArray(e))return e}function ke(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?ke(Object(t),!0).forEach(function(a){ae(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ke(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function ae(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function z(e,n){if(e==null)return{};var t=ir(e,n),a,u;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(u=0;u<s.length;u++)a=s[u],!(n.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}function ir(e,n){if(e==null)return{};var t={},a=Object.keys(e),u,s;for(s=0;s<a.length;s++)u=a[s],!(n.indexOf(u)>=0)&&(t[u]=e[u]);return t}var le=l.forwardRef(function(e,n){var t=e.children,a=z(e,Ge),u=lr(a),s=u.open,b=z(u,Qe);return l.useImperativeHandle(n,function(){return{open:s}},[s]),Le.createElement(l.Fragment,null,t(c(c({},b),{},{open:s})))});le.displayName="Dropzone";var Se={disabled:!1,getFilesFromEvent:He,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};le.defaultProps=Se;le.propTypes={children:i.func,accept:i.oneOfType([i.string,i.arrayOf(i.string)]),multiple:i.bool,preventDropOnDocument:i.bool,noClick:i.bool,noKeyboard:i.bool,noDrag:i.bool,noDragEventsBubbling:i.bool,minSize:i.number,maxSize:i.number,maxFiles:i.number,disabled:i.bool,getFilesFromEvent:i.func,onFileDialogCancel:i.func,onFileDialogOpen:i.func,useFsAccessApi:i.bool,onDragEnter:i.func,onDragLeave:i.func,onDragOver:i.func,onDrop:i.func,onDropAccepted:i.func,onDropRejected:i.func,validator:i.func};var ie={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function lr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=c(c({},Se),e),t=n.accept,a=n.disabled,u=n.getFilesFromEvent,s=n.maxSize,b=n.minSize,v=n.multiple,h=n.maxFiles,T=n.onDragEnter,L=n.onDragLeave,H=n.onDragOver,M=n.onDrop,B=n.onDropAccepted,W=n.onDropRejected,N=n.onFileDialogCancel,$=n.onFileDialogOpen,ue=n.useFsAccessApi,U=n.preventDropOnDocument,ce=n.noClick,q=n.noKeyboard,se=n.noDrag,F=n.noDragEventsBubbling,J=n.validator,Y=l.useMemo(function(){return typeof $=="function"?$:we},[$]),k=l.useMemo(function(){return typeof N=="function"?N:we},[N]),d=l.useRef(null),D=l.useRef(null),Re=l.useReducer(ur,ie),fe=te(Re,2),w=fe[0],g=fe[1],je=w.isFocused,pe=w.isFileDialogActive,ge=w.draggedFiles,P=l.useRef(typeof window<"u"&&window.isSecureContext&&ue&&Me()),de=function(){!P.current&&pe&&setTimeout(function(){if(D.current){var o=D.current.files;o.length||(g({type:"closeDialog"}),k())}},300)};l.useEffect(function(){return window.addEventListener("focus",de,!1),function(){window.removeEventListener("focus",de,!1)}},[D,pe,k,P]);var O=l.useRef([]),De=function(o){d.current&&d.current.contains(o.target)||(o.preventDefault(),O.current=[])};l.useEffect(function(){return U&&(document.addEventListener("dragover",Ee,!1),document.addEventListener("drop",De,!1)),function(){U&&(document.removeEventListener("dragover",Ee),document.removeEventListener("drop",De))}},[d,U]);var ve=l.useCallback(function(r){r.preventDefault(),r.persist(),x(r),O.current=[].concat(Ze(O.current),[r.target]),K(r)&&Promise.resolve(u(r)).then(function(o){_e(r)&&!F||(g({draggedFiles:o,isDragActive:!0,type:"setDraggedFiles"}),T&&T(r))})},[u,T,F]),me=l.useCallback(function(r){r.preventDefault(),r.persist(),x(r);var o=K(r);if(o&&r.dataTransfer)try{r.dataTransfer.dropEffect="copy"}catch{}return o&&H&&H(r),!1},[H,F]),ye=l.useCallback(function(r){r.preventDefault(),r.persist(),x(r);var o=O.current.filter(function(p){return d.current&&d.current.contains(p)}),f=o.indexOf(r.target);f!==-1&&o.splice(f,1),O.current=o,!(o.length>0)&&(g({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),K(r)&&L&&L(r))},[d,L,F]),S=l.useCallback(function(r,o){var f=[],p=[];r.forEach(function(m){var _=Be(m,t),E=te(_,2),Q=E[0],V=E[1],X=We(m,b,s),I=te(X,2),Z=I[0],ee=I[1],re=J?J(m):null;if(Q&&Z&&!re)f.push(m);else{var ne=[V,ee];re&&(ne=ne.concat(re)),p.push({file:m,errors:ne.filter(function(Te){return Te})})}}),(!v&&f.length>1||v&&h>=1&&f.length>h)&&(f.forEach(function(m){p.push({file:m,errors:[Ne]})}),f.splice(0)),g({acceptedFiles:f,fileRejections:p,type:"setFiles"}),M&&M(f,p,o),p.length>0&&W&&W(p,o),f.length>0&&B&&B(f,o)},[g,v,t,b,s,h,M,B,W,J]),R=l.useCallback(function(r){r.preventDefault(),r.persist(),x(r),O.current=[],K(r)&&Promise.resolve(u(r)).then(function(o){_e(r)&&!F||S(o,r)}),g({type:"reset"})},[u,S,F]),C=l.useCallback(function(){if(P.current){g({type:"openDialog"}),Y();var r={multiple:v,types:$e(t)};window.showOpenFilePicker(r).then(function(o){return u(o)}).then(function(o){S(o,null),g({type:"closeDialog"})}).catch(function(o){Ue(o)?(k(o),g({type:"closeDialog"})):qe(o)&&(P.current=!1,D.current&&(D.current.value=null,D.current.click()))});return}D.current&&(g({type:"openDialog"}),Y(),D.current.value=null,D.current.click())},[g,Y,k,ue,S,t,v]),be=l.useCallback(function(r){!d.current||!d.current.isEqualNode(r.target)||(r.key===" "||r.key==="Enter"||r.keyCode===32||r.keyCode===13)&&(r.preventDefault(),C())},[d,C]),Fe=l.useCallback(function(){g({type:"focus"})},[]),he=l.useCallback(function(){g({type:"blur"})},[]),Oe=l.useCallback(function(){ce||(Je()?setTimeout(C,0):C())},[ce,C]),A=function(o){return a?null:o},G=function(o){return q?null:A(o)},j=function(o){return se?null:A(o)},x=function(o){F&&o.stopPropagation()},xe=l.useMemo(function(){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.refKey,f=o===void 0?"ref":o,p=r.role,m=r.onKeyDown,_=r.onFocus,E=r.onBlur,Q=r.onClick,V=r.onDragEnter,X=r.onDragOver,I=r.onDragLeave,Z=r.onDrop,ee=z(r,Ve);return c(c(ae({onKeyDown:G(y(m,be)),onFocus:G(y(_,Fe)),onBlur:G(y(E,he)),onClick:A(y(Q,Oe)),onDragEnter:j(y(V,ve)),onDragOver:j(y(X,me)),onDragLeave:j(y(I,ye)),onDrop:j(y(Z,R)),role:typeof p=="string"&&p!==""?p:"button"},f,d),!a&&!q?{tabIndex:0}:{}),ee)}},[d,be,Fe,he,Oe,ve,me,ye,R,q,se,a]),Ie=l.useCallback(function(r){r.stopPropagation()},[]),Ke=l.useMemo(function(){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=r.refKey,f=o===void 0?"ref":o,p=r.onChange,m=r.onClick,_=z(r,Xe),E=ae({accept:t,multiple:v,type:"file",style:{display:"none"},onChange:A(y(p,R)),onClick:A(y(m,Ie)),tabIndex:-1},f,D);return c(c({},E),_)}},[D,t,v,R,a]),Ce=ge.length,Ae=Ce>0&&Ye({files:ge,accept:t,minSize:b,maxSize:s,multiple:v,maxFiles:h}),ze=Ce>0&&!Ae;return c(c({},w),{},{isDragAccept:Ae,isDragReject:ze,isFocused:je&&!a,getRootProps:xe,getInputProps:Ke,rootRef:d,inputRef:D,open:A(C)})}function ur(e,n){switch(n.type){case"focus":return c(c({},e),{},{isFocused:!0});case"blur":return c(c({},e),{},{isFocused:!1});case"openDialog":return c(c({},ie),{},{isFileDialogActive:!0});case"closeDialog":return c(c({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":var t=n.isDragActive,a=n.draggedFiles;return c(c({},e),{},{draggedFiles:a,isDragActive:t});case"setFiles":return c(c({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections});case"reset":return c({},ie);default:return e}}function we(){}export{lr as u};
//# sourceMappingURL=index.js.rRr0PZI6.js.map

import{r as t}from"../../../../../../react/index.js.CiILtb88.js";import{g as j,a as z,b as G}from"./get-index/get-index.mjs.DuhRJbD6.js";import{u as H}from"../../../../../hooks/esm/use-uncontrolled/use-uncontrolled.mjs.DZJQyLGt.js";function Q({defaultOpened:C,opened:y,onOpenedChange:T,onDropdownClose:l,onDropdownOpen:i,loop:d=!0,scrollBehavior:f="instant"}={}){const[a,b]=H({value:y,defaultValue:C,finalValue:!1,onChange:T}),n=t.useRef(null),s=t.useRef(-1),I=t.useRef(null),A=t.useRef(null),S=t.useRef(-1),g=t.useRef(-1),p=t.useRef(-1),x=t.useCallback((e="unknown")=>{a||(b(!0),i==null||i(e))},[b,i,a]),k=t.useCallback((e="unknown")=>{a&&(b(!1),l==null||l(e))},[b,l,a]),q=t.useCallback((e="unknown")=>{a?k(e):x(e)},[k,x,a]),m=t.useCallback(()=>{const e=document.querySelector(`#${n.current} [data-combobox-selected]`);e==null||e.removeAttribute("data-combobox-selected"),e==null||e.removeAttribute("aria-selected")},[]),u=t.useCallback(e=>{const o=document.getElementById(n.current),c=o==null?void 0:o.querySelectorAll("[data-combobox-option]");if(!c)return null;const r=e>=c.length?0:e<0?c.length-1:e;return s.current=r,c!=null&&c[r]&&!c[r].hasAttribute("data-combobox-disabled")?(m(),c[r].setAttribute("data-combobox-selected","true"),c[r].setAttribute("aria-selected","true"),c[r].scrollIntoView({block:"nearest",behavior:f}),c[r].id):null},[f,m]),O=t.useCallback(()=>{const e=document.querySelector(`#${n.current} [data-combobox-active]`);if(e){const o=document.querySelectorAll(`#${n.current} [data-combobox-option]`),c=Array.from(o).findIndex(r=>r===e);return u(c)}return u(0)},[u]),R=t.useCallback(()=>u(j(s.current,document.querySelectorAll(`#${n.current} [data-combobox-option]`),d)),[u,d]),$=t.useCallback(()=>u(z(s.current,document.querySelectorAll(`#${n.current} [data-combobox-option]`),d)),[u,d]),h=t.useCallback(()=>u(G(document.querySelectorAll(`#${n.current} [data-combobox-option]`))),[u]),v=t.useCallback((e="selected",o)=>{p.current=window.setTimeout(()=>{var w;const c=document.querySelectorAll(`#${n.current} [data-combobox-option]`),r=Array.from(c).findIndex(L=>L.hasAttribute(`data-combobox-${e}`));s.current=r,o!=null&&o.scrollIntoView&&((w=c[r])==null||w.scrollIntoView({block:"nearest",behavior:f}))},0)},[]),V=t.useCallback(()=>{s.current=-1,m()},[m]),E=t.useCallback(()=>{const e=document.querySelectorAll(`#${n.current} [data-combobox-option]`),o=e==null?void 0:e[s.current];o==null||o.click()},[]),F=t.useCallback(e=>{n.current=e},[]),N=t.useCallback(()=>{S.current=window.setTimeout(()=>I.current.focus(),0)},[]),P=t.useCallback(()=>{g.current=window.setTimeout(()=>A.current.focus(),0)},[]),U=t.useCallback(()=>s.current,[]);return t.useEffect(()=>()=>{window.clearTimeout(S.current),window.clearTimeout(g.current),window.clearTimeout(p.current)},[]),{dropdownOpened:a,openDropdown:x,closeDropdown:k,toggleDropdown:q,selectedOptionIndex:s.current,getSelectedOptionIndex:U,selectOption:u,selectFirstOption:h,selectActiveOption:O,selectNextOption:R,selectPreviousOption:$,resetSelectedOption:V,updateSelectedOptionIndex:v,listId:n.current,setListId:F,clickSelectedOption:E,searchRef:I,focusSearchInput:N,targetRef:A,focusTarget:P}}export{Q as u};

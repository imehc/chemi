import{_ as u,i as y,t as _,E as S,a as p,c as E,p as O,b as P,C as w,d as I,S as T}from"./actions-fe213e88.esm.js._hhkJEmH.js";function j(t,e){if(t==null)return{};var s={},r=Object.keys(t),i,n;for(n=0;n<r.length;n++)i=r[n],!(e.indexOf(i)>=0)&&(s[i]=t[i]);return s}function k(t,e){if(t==null)return{};var s=j(t,e),r,i;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(i=0;i<n.length;i++)r=n[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}const C={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=T.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},K=["target","eventOptions","window","enabled","transform"];function g(t={},e){const s={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":s[r]=i.call(s,t[r],r,t);break;case"object":s[r]=g(t[r],i);break;case"boolean":i&&(s[r]=t[r]);break}return s}function x(t,e,s={}){const r=t,{target:i,eventOptions:n,window:o,enabled:a,transform:h}=r,c=k(r,K);if(s.shared=g({target:i,eventOptions:n,window:o,enabled:a,transform:h},C),e){const d=w.get(e);s[e]=g(p({shared:s.shared},c),d)}else for(const d in c){const l=w.get(d);l&&(s[d]=g(p({shared:s.shared},c[d]),l))}return s}class b{constructor(e,s){u(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=s}add(e,s,r,i,n){const o=this._listeners,a=I(s,r),h=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=p(p({},h),n);e.addEventListener(a,i,c);const d=()=>{e.removeEventListener(a,i,c),o.delete(d)};return o.add(d),d}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class L{constructor(){u(this,"_timeouts",new Map)}add(e,s,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(s,r,...i))}remove(e){const s=this._timeouts.get(e);s&&window.clearTimeout(s)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class W{constructor(e){u(this,"gestures",new Set),u(this,"_targetEventStore",new b(this)),u(this,"gestureEventStores",{}),u(this,"gestureTimeoutStores",{}),u(this,"handlers",{}),u(this,"config",{}),u(this,"pointerIds",new Set),u(this,"touchIds",new Set),u(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),M(this,e)}setEventIds(e){if(y(e))return this.touchIds=new Set(_(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,s){this.handlers=e,this.nativeHandlers=s}applyConfig(e,s){this.config=x(e,s,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const s=this.config.shared,r={};let i;if(!(s.target&&(i=s.target(),!i))){if(s.enabled){for(const o of this.gestures){const a=this.config[o],h=m(r,a.eventOptions,!!i);if(a.enabled){const c=S.get(o);new c(this,e,o).bind(h)}}const n=m(r,s.eventOptions,!!i);for(const o in this.nativeHandlers)n(o,"",a=>this.nativeHandlers[o](p(p({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const n in r)r[n]=E(...r[n]);if(!i)return r;for(const n in r){const{device:o,capture:a,passive:h}=O(n);this._targetEventStore.add(i,o,"",r[n],{capture:a,passive:h})}}}}function f(t,e){t.gestures.add(e),t.gestureEventStores[e]=new b(t,e),t.gestureTimeoutStores[e]=new L}function M(t,e){e.drag&&f(t,"drag"),e.wheel&&f(t,"wheel"),e.scroll&&f(t,"scroll"),e.move&&f(t,"move"),e.pinch&&f(t,"pinch"),e.hover&&f(t,"hover")}const m=(t,e,s)=>(r,i,n,o={},a=!1)=>{var h,c;const d=(h=o.capture)!==null&&h!==void 0?h:e.capture,l=(c=o.passive)!==null&&c!==void 0?c:e.passive;let v=a?r:P(r,i,d);s&&l&&(v+="Passive"),t[v]=t[v]||[],t[v].push(n)};export{W as C};

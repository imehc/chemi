import{s as C,c as ee,_ as E,g as we,u as F,r as le,a as _e,S as A,b as He,d as _,e as W,P as Ce,l as Ve,L as U,f as ie,h as Fe,i as Ae,j as We,k as Ne,m as Re,n as Be,o as Ue,p as Ge,q as H,t as V,v as Z,R as N,w as K,V as ce,x as Ke,y as q,z as ge,A as Ye,I as Je,B as qe,C as Xe,D as ue,E as Se,F as Ze,G as Qe,H as et,J as tt,K as nt,M as de,O as xe,N as ot,Q as rt,T as st,U as it,W as at,X as lt,Y as ct,Z as ne,$ as ut,a0 as me,a1 as dt,a2 as ft,a3 as ht,a4 as gt,a5 as pe,a6 as mt}from"./vector-plugin-6f82aee9.esm.js.ClWPKdiL.js";import{v as Q}from"../../v8n/dist/v8n.esm.js.RmYqvSmG.js";import{k as pt,w as X,I as vt}from"../../colord/index.mjs.DBTcbsYJ.js";import{n as bt}from"../../colord/plugins/names.mjs.CbN76U8r.js";import{d as Et}from"../../dequal/lite/index.mjs.CnqicUFC.js";import"../../react-dom/index.js.LUY0HZwr.js";import{r as d,R as s}from"../../react/index.js.CiILtb88.js";import{C as yt,N as $t}from"../../react-colorful/dist/index.mjs.CSSL8KD6.js";import{s as ae}from"../../zustand/esm/shallow.js.C2oVrJi4.js";import{u as wt}from"../../react-dropzone/dist/es/index.js.Dwgpn0pO.js";import{c as Ct}from"../../zustand/esm/index.js.BKqfLw1g.js";import{s as Rt}from"../../zustand/esm/middleware.js.DAG3BtOX.js";import{m as St}from"../../merge-value/index.js.DFdnvR1B.js";const fe=(...e)=>e.filter(Boolean).join(".");function xt(e){const t=e.split(".");return[t.pop(),t.join(".")||void 0]}function Pt(e,t){return Object.entries(lt(e,t)).reduce((n,[,{value:r,disabled:i,key:c}])=>(n[c]=i?void 0:r,n),{})}function kt(e,t){const n=d.useRef();return(t?Et:ae)(e,n.current)||(n.current=e),n.current}function Pe(e,t){return d.useMemo(e,kt(t,!0))}function Tt(e){const t=d.useRef(null),n=d.useRef(null),r=d.useRef(!0);return d.useLayoutEffect(()=>{e||(t.current.style.height="0px",t.current.style.overflow="hidden")},[]),d.useEffect(()=>{if(r.current){r.current=!1;return}let i;const c=t.current,o=()=>{e&&(c.style.removeProperty("height"),c.style.removeProperty("overflow"),n.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};c.addEventListener("transitionend",o,{once:!0});const{height:l}=n.current.getBoundingClientRect();return c.style.height=l+"px",e||(c.style.overflow="hidden",i=window.setTimeout(()=>c.style.height="0px",50)),()=>{c.removeEventListener("transitionend",o),clearTimeout(i)}},[e]),{wrapperRef:t,contentRef:n}}const It=e=>{const[t,n]=d.useState(e.getVisiblePaths());return d.useEffect(()=>{n(e.getVisiblePaths());const r=e.useStore.subscribe(e.getVisiblePaths,n,{equalityFn:ae});return()=>r()},[e]),t};function zt(e,t,n){return e.useStore(i=>{const c=E(E({},n),i.data);return Pt(c,t)},ae)}function ke(e=3){const t=d.useRef(null),n=d.useRef(null),[r,i]=d.useState(!1),c=d.useCallback(()=>i(!0),[]),o=d.useCallback(()=>i(!1),[]);return d.useLayoutEffect(()=>{if(r){const{bottom:l,top:a,left:u}=t.current.getBoundingClientRect(),{height:f}=n.current.getBoundingClientRect(),m=l+f>window.innerHeight-40?"up":"down";n.current.style.position="fixed",n.current.style.zIndex="10000",n.current.style.left=u+"px",m==="down"?n.current.style.top=l+e+"px":n.current.style.bottom=window.innerHeight-a+e+"px"}},[e,r]),{popinRef:t,wrapperRef:n,shown:r,show:c,hide:o}}pt([bt]);const jt={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};Q.extend({color:()=>e=>X(e).isValid()});const Ot=e=>Q().color().test(e);function Te(e,{format:t,hasAlpha:n,isString:r}){const i=jt[t]+(r&&t!=="hex"?"String":""),c=e[i]();return typeof c=="object"&&!n?mt(c,["a"]):c}const Ie=(e,t)=>{const n=X(e);if(!n.isValid())throw Error("Invalid color");return Te(n,t)},Lt=(e,t)=>Te(X(e),E(E({},t),{},{isString:!0,format:"hex"})),Dt=({value:e})=>{const t=vt(e),n=t==="name"?"hex":t,r=typeof e=="object"?"a"in e:t==="hex"&&e.length===8||/^(rgba)|(hsla)|(hsva)/.test(e),i={format:n,hasAlpha:r,isString:typeof e=="string"};return{value:Ie(e,i),settings:i}};var Mt=Object.freeze({__proto__:null,schema:Ot,sanitize:Ie,format:Lt,normalize:Dt});const _t=C("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),Ht=C("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),Vt=C("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function ve(e,t){return t!=="rgb"?X(e).toRgb():e}function Ft({value:e,displayValue:t,settings:n,onUpdate:r}){const{emitOnEditStart:i,emitOnEditEnd:c}=Z(),{format:o,hasAlpha:l}=n,{popinRef:a,wrapperRef:u,shown:f,show:m,hide:g}=ke(),v=d.useRef(0),[p,h]=d.useState(()=>ve(e,o)),w=l?yt:$t,$=()=>{h(ve(e,o)),m(),i()},y=()=>{g(),c(),window.clearTimeout(v.current)},I=()=>{v.current=window.setTimeout(y,500)};return d.useEffect(()=>()=>window.clearTimeout(v.current),[]),s.createElement(s.Fragment,null,s.createElement(_t,{ref:a,active:f,onClick:()=>$(),style:{color:t}}),f&&s.createElement(de,null,s.createElement(xe,{onPointerUp:y}),s.createElement(Vt,{ref:u,onMouseEnter:()=>window.clearTimeout(v.current),onMouseLeave:k=>k.buttons===0&&I()},s.createElement(w,{color:p,onChange:r}))))}function At(){const{value:e,displayValue:t,label:n,onChange:r,onUpdate:i,settings:c}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,n),s.createElement(Ht,null,s.createElement(Ft,{value:e,displayValue:t,onChange:r,onUpdate:i,settings:c}),s.createElement(nt,{value:t,onChange:r,onUpdate:i})))}var Wt=ee(E({component:At},Mt));function Nt(){const{label:e,displayValue:t,onUpdate:n,settings:r}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(ce,{value:t,settings:r,onUpdate:n}))}var Bt=ee(E({component:Nt},we(["x","y","z"])));const Ut=C("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),Gt=C("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Kt({value:e,settings:t,onUpdate:n}){const r=d.useRef(),i=d.useRef(0),c=d.useRef(0),o=d.useRef(1),[l,a]=d.useState(!1),[u,f]=d.useState(!1),[m,g]=Re(),v=d.useRef(null),p=d.useRef(null);d.useLayoutEffect(()=>{if(l){const{top:b,left:S,width:L,height:D}=v.current.getBoundingClientRect();p.current.style.left=S+L/2+"px",p.current.style.top=b+D/2+"px"}},[l]);const{keys:[h,w],joystick:$}=t,y=$==="invertY"?1:-1,{[h]:{step:I},[w]:{step:k}}=t,j=F("sizes","joystickWidth"),x=F("sizes","joystickHeight"),P=parseFloat(j)*.8/2,O=parseFloat(x)*.8/2,M=d.useCallback(()=>{r.current||(f(!0),i.current&&g({x:i.current*P}),c.current&&g({y:c.current*-O}),r.current=window.setInterval(()=>{n(b=>{const S=I*i.current*o.current,L=y*k*c.current*o.current;return Array.isArray(b)?{[h]:b[0]+S,[w]:b[1]+L}:{[h]:b[h]+S,[w]:b[w]+L}})},16))},[P,O,n,g,I,k,h,w,y]),T=d.useCallback(()=>{window.clearTimeout(r.current),r.current=void 0,f(!1)},[]);d.useEffect(()=>{function b(S){o.current=ct(S)}return window.addEventListener("keydown",b),window.addEventListener("keyup",b),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",b),window.removeEventListener("keyup",b)}},[]);const R=ue(({first:b,active:S,delta:[L,D],movement:[z,B]})=>{b&&a(!0);const Y=ne(z,-P,P),J=ne(B,-O,O);i.current=Math.abs(z)>Math.abs(Y)?Math.sign(z-Y):0,c.current=Math.abs(B)>Math.abs(J)?Math.sign(J-B):0;let te=e[h],he=e[w];S?(i.current||(te+=L*I*o.current,g({x:Y})),c.current||(he-=y*D*k*o.current,g({y:J})),i.current||c.current?M():T(),n({[h]:te,[w]:he})):(a(!1),i.current=0,c.current=0,g({x:0,y:0}),T())});return s.createElement(Ut,W({ref:v},R()),l&&s.createElement(de,null,s.createElement(Gt,{ref:p,isOutOfBounds:u},s.createElement("div",null),s.createElement("span",{ref:m}))))}const Yt=C("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Jt(){const{label:e,displayValue:t,onUpdate:n,settings:r}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(Yt,{withJoystick:!!r.joystick},r.joystick&&s.createElement(Kt,{value:t,settings:r,onUpdate:n}),s.createElement(ce,{value:t,settings:r,onUpdate:n})))}const qt=["joystick"],ze=we(["x","y"]),Xt=e=>{let{joystick:t=!0}=e,n=_(e,qt);const{value:r,settings:i}=ze.normalize(n);return{value:r,settings:E(E({},i),{},{joystick:t})}};var Zt=ee(E(E({component:Jt},ze),{},{normalize:Xt}));const Qt=e=>{if(e!==void 0){if(e instanceof File)try{return URL.createObjectURL(e)}catch{return}if(typeof e=="string"&&e.indexOf("blob:")===0)return e;throw Error("Invalid image format [undefined | blob |Â File].")}},en=(e,t)=>typeof t=="object"&&"image"in t,tn=({image:e})=>({value:e});var nn=Object.freeze({__proto__:null,sanitize:Qt,schema:en,normalize:tn});const on=C("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),rn=C("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),sn=C("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),an=C("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),ln=C("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),cn=C("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function un(){const{label:e,value:t,onUpdate:n,disabled:r}=Z(),{popinRef:i,wrapperRef:c,shown:o,show:l,hide:a}=ke(),u=d.useCallback(p=>{p.length&&n(p[0])},[n]),f=d.useCallback(p=>{p.stopPropagation(),n(void 0)},[n]),{getRootProps:m,getInputProps:g,isDragAccept:v}=wt({maxFiles:1,accept:"image/*",onDrop:u,disabled:r});return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(on,null,s.createElement(sn,{ref:i,hasImage:!!t,onPointerDown:()=>!!t&&l(),onPointerUp:a,style:{backgroundImage:t?`url(${t})`:"none"}}),o&&!!t&&s.createElement(de,null,s.createElement(xe,{onPointerUp:a,style:{cursor:"pointer"}}),s.createElement(an,{ref:c,style:{backgroundImage:`url(${t})`}})),s.createElement(rn,m({isDragAccept:v}),s.createElement("input",g()),s.createElement(ln,null,v?"drop image":"click or drop")),s.createElement(cn,{onClick:f,disabled:!t})))}var dn=ee(E({component:un},nn));const be=Q().number(),fn=(e,t)=>Q().array().length(2).every.number().test(e)&&Q().schema({min:be,max:be}).test(t),oe=e=>({min:e[0],max:e[1]}),je=(e,{bounds:[t,n]},r)=>{const i=Array.isArray(e)?oe(e):e,c={min:r[0],max:r[1]},{min:o,max:l}=E(E({},c),i);return[ne(Number(o),t,Math.max(t,l)),ne(Number(l),Math.min(n,o),n)]},hn=({value:e,min:t,max:n})=>{const r={min:t,max:n},i=ut(oe(e),{min:r,max:r}),c=[t,n],o=E(E({},i),{},{bounds:c});return{value:je(oe(e),o,e),settings:o}};var gn=Object.freeze({__proto__:null,schema:fn,format:oe,sanitize:je,normalize:hn});const mn=["value","bounds","onDrag"],pn=["bounds"],vn=C("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function bn(e){let{value:t,bounds:[n,r],onDrag:i}=e,c=_(e,mn);const o=d.useRef(null),l=d.useRef(null),a=d.useRef(null),u=d.useRef(0),f=F("sizes","scrubberWidth"),m=ue(({event:p,first:h,xy:[w],movement:[$],memo:y={}})=>{if(h){const{width:k,left:j}=o.current.getBoundingClientRect();u.current=k-parseFloat(f);const x=(p==null?void 0:p.target)===l.current||(p==null?void 0:p.target)===a.current;y.pos=me((w-j)/k,n,r);const P=Math.abs(y.pos-t.min)-Math.abs(y.pos-t.max);y.key=P<0||P===0&&y.pos<=t.min?"min":"max",x&&(y.pos=t[y.key])}const I=y.pos+me($/u.current,0,r-n);return i({[y.key]:dt(I,c[y.key])}),y}),g=`calc(${le(t.min,n,r)} * (100% - ${f} - 8px) + 4px)`,v=`calc(${1-le(t.max,n,r)} * (100% - ${f} - 8px) + 4px)`;return s.createElement(ft,W({ref:o},m()),s.createElement(ht,null,s.createElement(gt,{style:{left:g,right:v}})),s.createElement(pe,{position:"left",ref:l,style:{left:g}}),s.createElement(pe,{position:"right",ref:a,style:{right:v}}))}function En(){const{label:e,displayValue:t,onUpdate:n,settings:r}=Z(),i=_(r,pn);return s.createElement(s.Fragment,null,s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(vn,null,s.createElement(bn,W({value:t},r,{onDrag:n})),s.createElement(ce,{value:t,settings:i,onUpdate:n,innerLabelTrim:0}))))}var yn=ee(E({component:En},gn));const $n=()=>{const e=new Map;return{on:(t,n)=>{let r=e.get(t);r===void 0&&(r=new Set,e.set(t,r)),r.add(n)},off:(t,n)=>{const r=e.get(t);r!==void 0&&(r.delete(n),r.size===0&&e.delete(t))},emit:(t,...n)=>{const r=e.get(t);if(r!==void 0)for(const i of r)i(...n)}}},wn=["type","value"],Cn=["onChange","transient","onEditStart","onEditEnd"],Rn=function(){const t=Ct(Rt(()=>({data:{}}))),n=$n();this.storeId=Ke(),this.useStore=t;const r={},i=new Set;this.getVisiblePaths=()=>{const o=this.getData(),l=Object.keys(o),a=[];Object.entries(r).forEach(([f,m])=>{m.render&&l.some(g=>g.indexOf(f)===0)&&!m.render(this.get)&&a.push(f+".")});const u=[];return i.forEach(f=>{f in o&&o[f].__refCount>0&&a.every(m=>f.indexOf(m)===-1)&&(!o[f].render||o[f].render(this.get))&&u.push(f)}),u},this.setOrderedPaths=o=>{o.forEach(l=>i.add(l))},this.orderPaths=o=>(this.setOrderedPaths(o),o),this.disposePaths=o=>{t.setState(l=>{const a=l.data;return o.forEach(u=>{if(u in a){const f=a[u];f.__refCount--,f.__refCount===0&&f.type in A&&delete a[u]}}),{data:a}})},this.dispose=()=>{t.setState(()=>({data:{}}))},this.getFolderSettings=o=>r[o]||{},this.getData=()=>t.getState().data,this.addData=(o,l)=>{t.setState(a=>{const u=a.data;return Object.entries(o).forEach(([f,m])=>{let g=u[f];if(g){const{type:v,value:p}=m,h=_(m,wn);v!==g.type?q(U.INPUT_TYPE_OVERRIDE,v):((g.__refCount===0||l)&&Object.assign(g,h),g.__refCount++)}else u[f]=E(E({},m),{},{__refCount:1})}),{data:u}})},this.setValueAtPath=(o,l,a)=>{t.setState(u=>{const f=u.data;return ge(f[o],l,o,this,a),{data:f}})},this.setSettingsAtPath=(o,l)=>{t.setState(a=>{const u=a.data;return u[o].settings=E(E({},u[o].settings),l),{data:u}})},this.disableInputAtPath=(o,l)=>{t.setState(a=>{const u=a.data;return u[o].disabled=l,{data:u}})},this.set=(o,l)=>{t.setState(a=>{const u=a.data;return Object.entries(o).forEach(([f,m])=>{try{ge(u[f],m,void 0,void 0,l)}catch{}}),{data:u}})},this.getInput=o=>{try{return this.getData()[o]}catch{q(U.PATH_DOESNT_EXIST,o)}},this.get=o=>{var l;return(l=this.getInput(o))===null||l===void 0?void 0:l.value},this.emitOnEditStart=o=>{n.emit(`onEditStart:${o}`,this.get(o),o,E(E({},this.getInput(o)),{},{get:this.get}))},this.emitOnEditEnd=o=>{n.emit(`onEditEnd:${o}`,this.get(o),o,E(E({},this.getInput(o)),{},{get:this.get}))},this.subscribeToEditStart=(o,l)=>{const a=`onEditStart:${o}`;return n.on(a,l),()=>n.off(a,l)},this.subscribeToEditEnd=(o,l)=>{const a=`onEditEnd:${o}`;return n.on(a,l),()=>n.off(a,l)};const c=(o,l,a)=>{const u={};return Object.entries(o).forEach(([f,m])=>{if(f==="")return q(U.EMPTY_KEY);let g=fe(l,f);if(m.type===A.FOLDER){const v=c(m.schema,g,a);Object.assign(u,v),g in r||(r[g]=m.settings)}else if(f in a)q(U.DUPLICATE_KEYS,f,g,a[f].path);else{const v=ot(m,f,g,u);if(v){const{type:p,options:h,input:w}=v,{onChange:$,transient:y,onEditStart:I,onEditEnd:k}=h,j=_(h,Cn);u[g]=E(E(E({type:p},j),w),{},{fromPanel:!0}),a[f]={path:g,onChange:$,transient:y,onEditStart:I,onEditEnd:k}}else q(U.UNKNOWN_INPUT,g,m)}}),u};this.getDataFromSchema=o=>{const l={};return[c(o,"",l),l]}},Oe=new Rn,Sn={collapsed:!1};function xn(e,t){return{type:A.FOLDER,schema:e,settings:E(E({},Sn),t)}}const Pn={disabled:!1};function $o(e,t){return{type:A.BUTTON,onClick:e,settings:E(E({},Pn),t)}}const Ee=e=>"__levaInput"in e,kn=(e,t)=>{const n={},r=t?t.toLowerCase():null;return e.forEach(i=>{const[c,o]=xt(i);(!r||c.toLowerCase().indexOf(r)>-1)&&St(n,o,{[c]:{__levaInput:!0,path:i}})}),n},Tn=["type","label","path","valueKey","value","settings","setValue","disabled"];function In(e){let{type:t,label:n,path:r,valueKey:i,value:c,settings:o,setValue:l,disabled:a}=e,u=_(e,Tn);const{displayValue:f,onChange:m,onUpdate:g}=Ye({type:t,value:c,settings:o,setValue:l}),v=Ce[t].component;return v?s.createElement(Je.Provider,{value:E({key:i,path:r,id:""+r,label:n,displayValue:f,value:c,onChange:m,onUpdate:g,settings:o,setValue:l,disabled:a},u)},s.createElement(qe,{disabled:a},s.createElement(v,null))):(q(U.NO_COMPONENT_FOR_TYPE,t,r),null)}const zn=C("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function jn({onClick:e,settings:t,label:n}){const r=ie();return s.createElement(N,null,s.createElement(zn,{disabled:t.disabled,onClick:()=>e(r.get)},n))}const On=C("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),Ln=C("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),Dn=({label:e,opts:t})=>{let n=typeof e=="string"&&e.trim()===""?null:e,r=t;return typeof t.opts=="object"&&(r.label!==void 0&&(n=t.label),r=t.opts),{label:n,opts:r}};function Mn(e){const{label:t,opts:n}=Dn(e),r=ie();return s.createElement(N,{input:!!t},t&&s.createElement(K,null,t),s.createElement(On,null,Object.entries(n).map(([i,c])=>s.createElement(Ln,{key:i,onClick:()=>c(r.get)},i))))}const _n=C("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),Le=100;function Hn(e,t){e.push(t),e.length>Le&&e.shift()}const Vn=d.forwardRef(function({initialValue:e},t){const n=F("colors","highlight3"),r=F("colors","elevation2"),i=F("colors","highlight1"),[c,o]=d.useMemo(()=>[X(i).alpha(.4).toRgbString(),X(i).alpha(.1).toRgbString()],[i]),l=d.useRef([e]),a=d.useRef(e),u=d.useRef(e),f=d.useRef(),m=d.useCallback((p,h)=>{if(!p)return;const{width:w,height:$}=p,y=new Path2D,I=w/Le,k=$*.05;for(let P=0;P<l.current.length;P++){const O=le(l.current[P],a.current,u.current),M=I*P,T=$-O*($-k*2)-k;y.lineTo(M,T)}h.clearRect(0,0,w,$);const j=new Path2D(y);j.lineTo(I*(l.current.length+1),$),j.lineTo(0,$),j.lineTo(0,0);const x=h.createLinearGradient(0,0,0,$);x.addColorStop(0,c),x.addColorStop(1,o),h.fillStyle=x,h.fill(j),h.strokeStyle=r,h.lineJoin="round",h.lineWidth=14,h.stroke(y),h.strokeStyle=n,h.lineWidth=2,h.stroke(y)},[n,r,c,o]),[g,v]=_e(m);return d.useImperativeHandle(t,()=>({frame:p=>{(a.current===void 0||p<a.current)&&(a.current=p),(u.current===void 0||p>u.current)&&(u.current=p),Hn(l.current,p),f.current=requestAnimationFrame(()=>m(g.current,v.current))}}),[g,v,m]),d.useEffect(()=>()=>cancelAnimationFrame(f.current),[]),s.createElement(_n,{ref:g})}),ye=e=>Number.isFinite(e)?e.toPrecision(2):e.toString(),Fn=d.forwardRef(function({initialValue:e},t){const[n,r]=d.useState(ye(e));return d.useImperativeHandle(t,()=>({frame:i=>r(ye(i))}),[]),s.createElement("div",null,n)});function $e(e){return typeof e=="function"?e():e.current}function An({label:e,objectOrFn:t,settings:n}){const r=d.useRef(),i=d.useRef($e(t));return d.useEffect(()=>{const c=window.setInterval(()=>{var o;document.hidden||(o=r.current)===null||o===void 0||o.frame($e(t))},n.interval);return()=>window.clearInterval(c)},[t,n.interval]),s.createElement(N,{input:!0},s.createElement(K,{align:"top"},e),n.graph?s.createElement(Vn,{ref:r,initialValue:i.current}):s.createElement(Fn,{ref:r,initialValue:i.current}))}const Wn=["type","label","key"],Nn={[A.BUTTON]:jn,[A.BUTTON_GROUP]:Mn,[A.MONITOR]:An},Bn=s.memo(({path:e})=>{const[t,{set:n,setSettings:r,disable:i,storeId:c,emitOnEditStart:o,emitOnEditEnd:l}]=He(e);if(!t)return null;const{type:a,label:u,key:f}=t,m=_(t,Wn);if(a in A){const g=Nn[a];return s.createElement(g,W({label:u,path:e},m))}return a in Ce?s.createElement(In,W({key:c+e,type:a,label:u,storeId:c,path:e,valueKey:f,setValue:n,setSettings:r,disable:i,emitOnEditStart:o,emitOnEditEnd:l},m)):(Ve(U.UNSUPPORTED_INPUT,a,e),null)});function Un({toggle:e,toggled:t,name:n}){return s.createElement(rt,{onClick:()=>e()},s.createElement(Se,{toggled:t}),s.createElement("div",null,n))}const Gn=({name:e,path:t,tree:n})=>{const r=ie(),i=fe(t,e),{collapsed:c,color:o}=r.getFolderSettings(i),[l,a]=d.useState(!c),u=d.useRef(null),f=F("colors","folderWidgetColor"),m=F("colors","folderTextColor");return d.useLayoutEffect(()=>{u.current.style.setProperty("--leva-colors-folderWidgetColor",o||f),u.current.style.setProperty("--leva-colors-folderTextColor",o||m)},[o,f,m]),s.createElement(Xe,{ref:u},s.createElement(Un,{name:e,toggled:l,toggle:()=>a(g=>!g)}),s.createElement(De,{parent:i,tree:n,toggled:l}))},De=s.memo(({isRoot:e=!1,fill:t=!1,flat:n=!1,parent:r,tree:i,toggled:c})=>{const{wrapperRef:o,contentRef:l}=Tt(c),a=ie(),u=([m,g])=>{var v;return(Ee(g)?(v=a.getInput(g.path))===null||v===void 0?void 0:v.order:a.getFolderSettings(fe(r,m)).order)||0},f=Object.entries(i).sort((m,g)=>u(m)-u(g));return s.createElement(Fe,{ref:o,isRoot:e,fill:t,flat:n},s.createElement(Ae,{ref:l,isRoot:e,toggled:c},f.map(([m,g])=>Ee(g)?s.createElement(Bn,{key:g.path,valueKey:g.valueKey,path:g.path}):s.createElement(Gn,{key:m,name:m,path:r,tree:g}))))}),Kn=C("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${We}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),Me=40,re=C("i",{$flexCenter:"",width:Me,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),Yn=C("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),Jn=C("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${re}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),qn=C("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),Xn=C("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:Me}}}}),Zn=s.forwardRef(({setFilter:e,toggle:t},n)=>{const[r,i]=d.useState(""),c=d.useMemo(()=>Ne(e,250),[e]),o=()=>{e(""),i("")},l=a=>{const u=a.currentTarget.value;t(!0),i(u)};return d.useEffect(()=>{c(r)},[r,c]),s.createElement(s.Fragment,null,s.createElement(qn,{ref:n,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:a=>a.stopPropagation(),onChange:l}),s.createElement(re,{onClick:()=>o(),style:{visibility:r?"visible":"hidden"}},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},s.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function Qn({setFilter:e,onDrag:t,onDragStart:n,onDragEnd:r,toggle:i,toggled:c,title:o,drag:l,filterEnabled:a,from:u}){const[f,m]=d.useState(!1),g=d.useRef(null);d.useEffect(()=>{var p,h;f?(p=g.current)===null||p===void 0||p.focus():(h=g.current)===null||h===void 0||h.blur()},[f]);const v=ue(({offset:[p,h],first:w,last:$})=>{t({x:p,y:h}),w&&n({x:p,y:h}),$&&r({x:p,y:h})},{filterTaps:!0,from:({offset:[p,h]})=>[(u==null?void 0:u.x)||p,(u==null?void 0:u.y)||h]});return d.useEffect(()=>{const p=h=>{h.key==="L"&&h.shiftKey&&h.metaKey&&m(w=>!w)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]),s.createElement(s.Fragment,null,s.createElement(Yn,{mode:l?"drag":void 0},s.createElement(re,{active:!c,onClick:()=>i()},s.createElement(Se,{toggled:c,width:12,height:8})),s.createElement(Xn,W({},l?v():{},{drag:l,filterEnabled:a}),o===void 0&&l?s.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},s.createElement("circle",{cx:"2",cy:"2",r:"2"}),s.createElement("circle",{cx:"14",cy:"2",r:"2"}),s.createElement("circle",{cx:"26",cy:"2",r:"2"}),s.createElement("circle",{cx:"2",cy:"12",r:"2"}),s.createElement("circle",{cx:"14",cy:"12",r:"2"}),s.createElement("circle",{cx:"26",cy:"12",r:"2"})):o),a&&s.createElement(re,{active:f,onClick:()=>m(p=>!p)},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},s.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),s.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),s.createElement(Jn,{toggled:f},s.createElement(Zn,{ref:g,setFilter:e,toggle:i})))}const eo=["store","hidden","theme","collapsed"];function to(e){let{store:t,hidden:n=!1,theme:r,collapsed:i=!1}=e,c=_(e,eo);const o=Pe(()=>st(r),[r]),[l,a]=d.useState(!i),u=typeof i=="object"?!i.collapsed:l,f=d.useMemo(()=>typeof i=="object"?m=>{typeof m=="function"?i.onChange(!m(!i.collapsed)):i.onChange(!m)}:a,[i]);return!t||n?null:s.createElement(it.Provider,{value:o},s.createElement(no,W({store:t},c,{toggled:u,setToggle:f,rootClass:o.className})))}const no=s.memo(({store:e,rootClass:t,fill:n=!1,flat:r=!1,neverHide:i=!1,oneLineLabels:c=!1,titleBar:o={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:l=!1,toggled:a,setToggle:u})=>{var f,m;const g=It(e),[v,p]=d.useState(""),h=d.useMemo(()=>kn(g,v),[g,v]),[w,$]=Re(),y=i||g.length>0,I=typeof o=="object"&&o.title||void 0,k=typeof o=="object"&&(f=o.drag)!==null&&f!==void 0?f:!0,j=typeof o=="object"&&(m=o.filter)!==null&&m!==void 0?m:!0,x=typeof o=="object"&&o.position||void 0,P=typeof o=="object"&&o.onDrag||void 0,O=typeof o=="object"&&o.onDragStart||void 0,M=typeof o=="object"&&o.onDragEnd||void 0;return s.useEffect(()=>{$({x:x==null?void 0:x.x,y:x==null?void 0:x.y})},[x,$]),Be(),s.createElement(Ue.Provider,{value:{hideCopyButton:l}},s.createElement(Kn,{ref:w,className:t,fill:n,flat:r,oneLineLabels:c,hideTitleBar:!o,style:{display:y?"block":"none"}},o&&s.createElement(Qn,{onDrag:T=>{$(T),P==null||P(T)},onDragStart:T=>O==null?void 0:O(T),onDragEnd:T=>M==null?void 0:M(T),setFilter:p,toggle:T=>u(R=>T??!R),toggled:a,title:I,drag:k,filterEnabled:j,from:x}),y&&s.createElement(Ge.Provider,{value:e},s.createElement(De,{isRoot:!0,fill:n,flat:r,tree:h,toggled:a}))))}),oo=["isRoot"];let se=!1,G=null;function ro(e){let{isRoot:t=!1}=e,n=_(e,oo);return d.useEffect(()=>(se=!0,!t&&G&&(G.remove(),G=null),()=>{t||(se=!1)}),[t]),s.createElement(to,W({store:Oe},n))}function so(e){d.useEffect(()=>{e&&!se&&(G||(G=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(G),at(s.createElement(ro,{isRoot:!0}),G))),se=!0)},[e])}function io(e,t,n,r,i){let c,o,l,a,u;return typeof e=="string"?(o=e,c=t,Array.isArray(n)?u=n:n&&("store"in n?(a=n,u=r):(l=n,Array.isArray(r)?u=r:(a=r,u=i)))):(c=e,Array.isArray(t)?u=t:(a=t,u=n)),{schema:c,folderName:o,folderSettings:l,hookSettings:a,deps:u||[]}}function wo(e,t,n,r,i){const{folderName:c,schema:o,folderSettings:l,hookSettings:a,deps:u}=io(e,t,n,r,i),f=typeof o=="function",m=d.useRef(!1),g=d.useRef(!0),v=Pe(()=>{m.current=!0;const R=typeof o=="function"?o():o;return c?{[c]:xn(R,l)}:R},u),p=!(a!=null&&a.store);so(p);const[h]=d.useState(()=>(a==null?void 0:a.store)||Oe),[w,$]=d.useMemo(()=>h.getDataFromSchema(v),[h,v]),[y,I,k,j,x]=d.useMemo(()=>{const R=[],b=[],S={},L={},D={};return Object.values($).forEach(({path:z,onChange:B,onEditStart:Y,onEditEnd:J,transient:te})=>{R.push(z),B?(S[z]=B,te||b.push(z)):b.push(z),Y&&(L[z]=Y),J&&(D[z]=J)}),[R,b,S,L,D]},[$]),P=d.useMemo(()=>h.orderPaths(y),[y,h]),O=zt(h,I,w),M=d.useCallback(R=>{const b=Object.entries(R).reduce((S,[L,D])=>Object.assign(S,{[$[L].path]:D}),{});h.set(b,!1)},[h,$]),T=d.useCallback(R=>h.get($[R].path),[h,$]);return d.useEffect(()=>{const R=!g.current&&m.current;return h.addData(w,R),g.current=!1,m.current=!1,()=>h.disposePaths(P)},[h,P,w]),d.useEffect(()=>{const R=[];return Object.entries(k).forEach(([b,S])=>{S(h.get(b),b,E({initial:!0,get:h.get},h.getInput(b)));const L=h.useStore.subscribe(D=>{const z=D.data[b];return[z.disabled?void 0:z.value,z]},([D,z])=>S(D,b,E({initial:!1,get:h.get},z)),{equalityFn:ae});R.push(L)}),()=>R.forEach(b=>b())},[h,k]),d.useEffect(()=>{const R=[];return Object.entries(j).forEach(([b,S])=>R.push(h.subscribeToEditStart(b,S))),Object.entries(x).forEach(([b,S])=>R.push(h.subscribeToEditEnd(b,S))),()=>R.forEach(b=>b())},[j,x,h]),f?[O,M,T]:O}H(V.SELECT,Ze);H(V.IMAGE,dn);H(V.NUMBER,Qe);H(V.COLOR,Wt);H(V.STRING,et);H(V.BOOLEAN,tt);H(V.INTERVAL,yn);H(V.VECTOR3D,Bt);H(V.VECTOR2D,Zt);export{ro as L,$o as b,wo as u};

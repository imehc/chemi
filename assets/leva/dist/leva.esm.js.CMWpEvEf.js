import{s as C,c as ee,_ as E,g as we,u as V,r as ae,a as _e,S as A,b as Fe,d as _,e as W,P as Ce,l as He,L as U,f as ie,h as Ve,i as Ae,j as We,k as Ne,m as Se,n as Be,o as Ue,p as Ge,q as F,t as H,v as Z,R as N,w as K,V as le,x as Ke,y as q,z as ge,A as Ye,I as Je,B as qe,C as Xe,D as ce,E as Re,F as Ze,G as Qe,H as et,J as tt,K as nt,M as ue,O as xe,N as ot,Q as rt,T as st,U as it,W as at,X as lt,Y as ct,Z as ne,$ as ut,a0 as pe,a1 as dt,a2 as ft,a3 as ht,a4 as gt,a5 as me,a6 as pt}from"./vector-plugin-6f82aee9.esm.js.CFCGl2p1.js";import{v as Q}from"../../v8n/dist/v8n.esm.js.RmYqvSmG.js";import{k as mt,w as X,I as vt}from"../../colord/index.mjs.DBTcbsYJ.js";import{n as bt}from"../../colord/plugins/names.mjs.CbN76U8r.js";import{d as Et}from"../../dequal/lite/index.mjs.CnqicUFC.js";import"../../react-dom/index.js.DLK93kQg.js";import{r as u,R as s}from"../../react/index.js.IuPGg7Py.js";import{C as yt,N as $t}from"../../react-colorful/dist/index.mjs.B7aiSE2f.js";import{s as de}from"../../zustand/esm/shallow.js.C2oVrJi4.js";import{u as wt}from"../../react-dropzone/dist/es/index.js.X-P1BAuW.js";import{c as Ct}from"../../zustand/esm/index.js.Cv_BSyMC.js";import{s as St}from"../../zustand/esm/middleware.js.DAG3BtOX.js";import{m as Rt}from"../../merge-value/index.js.C15LZU0E.js";const fe=(...e)=>e.filter(Boolean).join(".");function xt(e){const t=e.split(".");return[t.pop(),t.join(".")||void 0]}function Pt(e,t){return Object.entries(lt(e,t)).reduce((o,[,{value:r,disabled:i,key:c}])=>(o[c]=i?void 0:r,o),{})}function kt(e,t){const o=u.useRef();return Et(e,o.current)||(o.current=e),o.current}function Pe(e,t){return u.useMemo(e,kt(t))}function Tt(e){const t=u.useRef(null),o=u.useRef(null),r=u.useRef(!0);return u.useLayoutEffect(()=>{e||(t.current.style.height="0px",t.current.style.overflow="hidden")},[]),u.useEffect(()=>{if(r.current){r.current=!1;return}let i;const c=t.current,n=()=>{e&&(c.style.removeProperty("height"),c.style.removeProperty("overflow"),o.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};c.addEventListener("transitionend",n,{once:!0});const{height:l}=o.current.getBoundingClientRect();return c.style.height=l+"px",e||(c.style.overflow="hidden",i=window.setTimeout(()=>c.style.height="0px",50)),()=>{c.removeEventListener("transitionend",n),clearTimeout(i)}},[e]),{wrapperRef:t,contentRef:o}}const It=e=>{const[t,o]=u.useState(e.getVisiblePaths());return u.useEffect(()=>{o(e.getVisiblePaths());const r=e.useStore.subscribe(e.getVisiblePaths,o,{equalityFn:de});return()=>r()},[e]),t};function Ot(e,t,o){return e.useStore(i=>{const c=E(E({},o),i.data);return Pt(c,t)},de)}function ke(e=3){const t=u.useRef(null),o=u.useRef(null),[r,i]=u.useState(!1),c=u.useCallback(()=>i(!0),[]),n=u.useCallback(()=>i(!1),[]);return u.useLayoutEffect(()=>{if(r){const{bottom:l,top:a,left:d}=t.current.getBoundingClientRect(),{height:f}=o.current.getBoundingClientRect(),p=l+f>window.innerHeight-40?"up":"down";o.current.style.position="fixed",o.current.style.zIndex="10000",o.current.style.left=d+"px",p==="down"?o.current.style.top=l+e+"px":o.current.style.bottom=window.innerHeight-a+e+"px"}},[e,r]),{popinRef:t,wrapperRef:o,shown:r,show:c,hide:n}}mt([bt]);const zt={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};Q.extend({color:()=>e=>X(e).isValid()});const jt=e=>Q().color().test(e);function Te(e,{format:t,hasAlpha:o,isString:r}){const i=zt[t]+(r&&t!=="hex"?"String":""),c=e[i]();return typeof c=="object"&&!o?pt(c,["a"]):c}const Ie=(e,t)=>{const o=X(e);if(!o.isValid())throw Error("Invalid color");return Te(o,t)},Lt=(e,t)=>Te(X(e),E(E({},t),{},{isString:!0,format:"hex"})),Dt=({value:e})=>{const t=vt(e),o=t==="name"?"hex":t,r=typeof e=="object"?"a"in e:t==="hex"&&e.length===8||/^(rgba)|(hsla)|(hsva)/.test(e),i={format:o,hasAlpha:r,isString:typeof e=="string"};return{value:Ie(e,i),settings:i}};var Mt=Object.freeze({__proto__:null,schema:jt,sanitize:Ie,format:Lt,normalize:Dt});const _t=C("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),Ft=C("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),Ht=C("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function ve(e,t){return t!=="rgb"?X(e).toRgb():e}function Vt({value:e,displayValue:t,settings:o,onUpdate:r}){const{emitOnEditStart:i,emitOnEditEnd:c}=Z(),{format:n,hasAlpha:l}=o,{popinRef:a,wrapperRef:d,shown:f,show:p,hide:g}=ke(),v=u.useRef(0),[m,h]=u.useState(()=>ve(e,n)),w=l?yt:$t,$=()=>{h(ve(e,n)),p(),i()},y=()=>{g(),c(),window.clearTimeout(v.current)},I=()=>{v.current=window.setTimeout(y,500)};return u.useEffect(()=>()=>window.clearTimeout(v.current),[]),s.createElement(s.Fragment,null,s.createElement(_t,{ref:a,active:f,onClick:()=>$(),style:{color:t}}),f&&s.createElement(ue,null,s.createElement(xe,{onPointerUp:y}),s.createElement(Ht,{ref:d,onMouseEnter:()=>window.clearTimeout(v.current),onMouseLeave:k=>k.buttons===0&&I()},s.createElement(w,{color:m,onChange:r}))))}function At(){const{value:e,displayValue:t,label:o,onChange:r,onUpdate:i,settings:c}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,o),s.createElement(Ft,null,s.createElement(Vt,{value:e,displayValue:t,onChange:r,onUpdate:i,settings:c}),s.createElement(nt,{value:t,onChange:r,onUpdate:i})))}var Wt=ee(E({component:At},Mt));function Nt(){const{label:e,displayValue:t,onUpdate:o,settings:r}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(le,{value:t,settings:r,onUpdate:o}))}var Bt=ee(E({component:Nt},we(["x","y","z"])));const Ut=C("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),Gt=C("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Kt({value:e,settings:t,onUpdate:o}){const r=u.useRef(),i=u.useRef(0),c=u.useRef(0),n=u.useRef(1),[l,a]=u.useState(!1),[d,f]=u.useState(!1),[p,g]=Se(),v=u.useRef(null),m=u.useRef(null);u.useLayoutEffect(()=>{if(l){const{top:b,left:R,width:L,height:D}=v.current.getBoundingClientRect();m.current.style.left=R+L/2+"px",m.current.style.top=b+D/2+"px"}},[l]);const{keys:[h,w],joystick:$}=t,y=$==="invertY"?1:-1,{[h]:{step:I},[w]:{step:k}}=t,z=V("sizes","joystickWidth"),x=V("sizes","joystickHeight"),P=parseFloat(z)*.8/2,j=parseFloat(x)*.8/2,M=u.useCallback(()=>{r.current||(f(!0),i.current&&g({x:i.current*P}),c.current&&g({y:c.current*-j}),r.current=window.setInterval(()=>{o(b=>{const R=I*i.current*n.current,L=y*k*c.current*n.current;return Array.isArray(b)?{[h]:b[0]+R,[w]:b[1]+L}:{[h]:b[h]+R,[w]:b[w]+L}})},16))},[P,j,o,g,I,k,h,w,y]),T=u.useCallback(()=>{window.clearTimeout(r.current),r.current=void 0,f(!1)},[]);u.useEffect(()=>{function b(R){n.current=ct(R)}return window.addEventListener("keydown",b),window.addEventListener("keyup",b),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",b),window.removeEventListener("keyup",b)}},[]);const S=ce(({first:b,active:R,delta:[L,D],movement:[O,B]})=>{b&&a(!0);const Y=ne(O,-P,P),J=ne(B,-j,j);i.current=Math.abs(O)>Math.abs(Y)?Math.sign(O-Y):0,c.current=Math.abs(B)>Math.abs(J)?Math.sign(J-B):0;let te=e[h],he=e[w];R?(i.current||(te+=L*I*n.current,g({x:Y})),c.current||(he-=y*D*k*n.current,g({y:J})),i.current||c.current?M():T(),o({[h]:te,[w]:he})):(a(!1),i.current=0,c.current=0,g({x:0,y:0}),T())});return s.createElement(Ut,W({ref:v},S()),l&&s.createElement(ue,null,s.createElement(Gt,{ref:m,isOutOfBounds:d},s.createElement("div",null),s.createElement("span",{ref:p}))))}const Yt=C("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Jt(){const{label:e,displayValue:t,onUpdate:o,settings:r}=Z();return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(Yt,{withJoystick:!!r.joystick},r.joystick&&s.createElement(Kt,{value:t,settings:r,onUpdate:o}),s.createElement(le,{value:t,settings:r,onUpdate:o})))}const qt=["joystick"],Oe=we(["x","y"]),Xt=e=>{let{joystick:t=!0}=e,o=_(e,qt);const{value:r,settings:i}=Oe.normalize(o);return{value:r,settings:E(E({},i),{},{joystick:t})}};var Zt=ee(E(E({component:Jt},Oe),{},{normalize:Xt}));const Qt=e=>{if(e!==void 0){if(e instanceof File)try{return URL.createObjectURL(e)}catch{return}if(typeof e=="string"&&e.indexOf("blob:")===0)return e;throw Error("Invalid image format [undefined | blob |Â File].")}},en=(e,t)=>typeof t=="object"&&"image"in t,tn=({image:e})=>({value:e});var nn=Object.freeze({__proto__:null,sanitize:Qt,schema:en,normalize:tn});const on=C("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),rn=C("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),sn=C("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),an=C("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),ln=C("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),cn=C("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function un(){const{label:e,value:t,onUpdate:o,disabled:r}=Z(),{popinRef:i,wrapperRef:c,shown:n,show:l,hide:a}=ke(),d=u.useCallback(m=>{m.length&&o(m[0])},[o]),f=u.useCallback(m=>{m.stopPropagation(),o(void 0)},[o]),{getRootProps:p,getInputProps:g,isDragAccept:v}=wt({maxFiles:1,accept:"image/*",onDrop:d,disabled:r});return s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(on,null,s.createElement(sn,{ref:i,hasImage:!!t,onPointerDown:()=>!!t&&l(),onPointerUp:a,style:{backgroundImage:t?`url(${t})`:"none"}}),n&&!!t&&s.createElement(ue,null,s.createElement(xe,{onPointerUp:a,style:{cursor:"pointer"}}),s.createElement(an,{ref:c,style:{backgroundImage:`url(${t})`}})),s.createElement(rn,p({isDragAccept:v}),s.createElement("input",g()),s.createElement(ln,null,v?"drop image":"click or drop")),s.createElement(cn,{onClick:f,disabled:!t})))}var dn=ee(E({component:un},nn));const be=Q().number(),fn=(e,t)=>Q().array().length(2).every.number().test(e)&&Q().schema({min:be,max:be}).test(t),oe=e=>({min:e[0],max:e[1]}),ze=(e,{bounds:[t,o]},r)=>{const i=Array.isArray(e)?oe(e):e,c={min:r[0],max:r[1]},{min:n,max:l}=E(E({},c),i);return[ne(Number(n),t,Math.max(t,l)),ne(Number(l),Math.min(o,n),o)]},hn=({value:e,min:t,max:o})=>{const r={min:t,max:o},i=ut(oe(e),{min:r,max:r}),c=[t,o],n=E(E({},i),{},{bounds:c});return{value:ze(oe(e),n,e),settings:n}};var gn=Object.freeze({__proto__:null,schema:fn,format:oe,sanitize:ze,normalize:hn});const pn=["value","bounds","onDrag"],mn=["bounds"],vn=C("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function bn(e){let{value:t,bounds:[o,r],onDrag:i}=e,c=_(e,pn);const n=u.useRef(null),l=u.useRef(null),a=u.useRef(null),d=u.useRef(0),f=V("sizes","scrubberWidth"),p=ce(({event:m,first:h,xy:[w],movement:[$],memo:y={}})=>{if(h){const{width:k,left:z}=n.current.getBoundingClientRect();d.current=k-parseFloat(f);const x=(m==null?void 0:m.target)===l.current||(m==null?void 0:m.target)===a.current;y.pos=pe((w-z)/k,o,r);const P=Math.abs(y.pos-t.min)-Math.abs(y.pos-t.max);y.key=P<0||P===0&&y.pos<=t.min?"min":"max",x&&(y.pos=t[y.key])}const I=y.pos+pe($/d.current,0,r-o);return i({[y.key]:dt(I,c[y.key])}),y}),g=`calc(${ae(t.min,o,r)} * (100% - ${f} - 8px) + 4px)`,v=`calc(${1-ae(t.max,o,r)} * (100% - ${f} - 8px) + 4px)`;return s.createElement(ft,W({ref:n},p()),s.createElement(ht,null,s.createElement(gt,{style:{left:g,right:v}})),s.createElement(me,{position:"left",ref:l,style:{left:g}}),s.createElement(me,{position:"right",ref:a,style:{right:v}}))}function En(){const{label:e,displayValue:t,onUpdate:o,settings:r}=Z(),i=_(r,mn);return s.createElement(s.Fragment,null,s.createElement(N,{input:!0},s.createElement(K,null,e),s.createElement(vn,null,s.createElement(bn,W({value:t},r,{onDrag:o})),s.createElement(le,{value:t,settings:i,onUpdate:o,innerLabelTrim:0}))))}var yn=ee(E({component:En},gn));const $n=()=>{const e=new Map;return{on:(t,o)=>{let r=e.get(t);r===void 0&&(r=new Set,e.set(t,r)),r.add(o)},off:(t,o)=>{const r=e.get(t);r!==void 0&&(r.delete(o),r.size===0&&e.delete(t))},emit:(t,...o)=>{const r=e.get(t);if(r!==void 0)for(const i of r)i(...o)}}},wn=["type","value"],Cn=["onChange","transient","onEditStart","onEditEnd"],Sn=function(){const t=Ct(St(()=>({data:{}}))),o=$n();this.storeId=Ke(),this.useStore=t;const r={},i=new Set;this.getVisiblePaths=()=>{const n=this.getData(),l=Object.keys(n),a=[];Object.entries(r).forEach(([f,p])=>{p.render&&l.some(g=>g.indexOf(f)===0)&&!p.render(this.get)&&a.push(f+".")});const d=[];return i.forEach(f=>{f in n&&n[f].__refCount>0&&a.every(p=>f.indexOf(p)===-1)&&(!n[f].render||n[f].render(this.get))&&d.push(f)}),d},this.setOrderedPaths=n=>{n.forEach(l=>i.add(l))},this.orderPaths=n=>(this.setOrderedPaths(n),n),this.disposePaths=n=>{t.setState(l=>{const a=l.data;return n.forEach(d=>{if(d in a){const f=a[d];f.__refCount--,f.__refCount===0&&f.type in A&&delete a[d]}}),{data:a}})},this.dispose=()=>{t.setState(()=>({data:{}}))},this.getFolderSettings=n=>r[n]||{},this.getData=()=>t.getState().data,this.addData=(n,l)=>{t.setState(a=>{const d=a.data;return Object.entries(n).forEach(([f,p])=>{let g=d[f];if(g){const{type:v,value:m}=p,h=_(p,wn);v!==g.type?q(U.INPUT_TYPE_OVERRIDE,v):((g.__refCount===0||l)&&Object.assign(g,h),g.__refCount++)}else d[f]=E(E({},p),{},{__refCount:1})}),{data:d}})},this.setValueAtPath=(n,l,a)=>{t.setState(d=>{const f=d.data;return ge(f[n],l,n,this,a),{data:f}})},this.setSettingsAtPath=(n,l)=>{t.setState(a=>{const d=a.data;return d[n].settings=E(E({},d[n].settings),l),{data:d}})},this.disableInputAtPath=(n,l)=>{t.setState(a=>{const d=a.data;return d[n].disabled=l,{data:d}})},this.set=(n,l)=>{t.setState(a=>{const d=a.data;return Object.entries(n).forEach(([f,p])=>{try{ge(d[f],p,void 0,void 0,l)}catch{}}),{data:d}})},this.getInput=n=>{try{return this.getData()[n]}catch{q(U.PATH_DOESNT_EXIST,n)}},this.get=n=>{var l;return(l=this.getInput(n))===null||l===void 0?void 0:l.value},this.emitOnEditStart=n=>{o.emit(`onEditStart:${n}`,this.get(n),n,E(E({},this.getInput(n)),{},{get:this.get}))},this.emitOnEditEnd=n=>{o.emit(`onEditEnd:${n}`,this.get(n),n,E(E({},this.getInput(n)),{},{get:this.get}))},this.subscribeToEditStart=(n,l)=>{const a=`onEditStart:${n}`;return o.on(a,l),()=>o.off(a,l)},this.subscribeToEditEnd=(n,l)=>{const a=`onEditEnd:${n}`;return o.on(a,l),()=>o.off(a,l)};const c=(n,l,a)=>{const d={};return Object.entries(n).forEach(([f,p])=>{if(f==="")return q(U.EMPTY_KEY);let g=fe(l,f);if(p.type===A.FOLDER){const v=c(p.schema,g,a);Object.assign(d,v),g in r||(r[g]=p.settings)}else if(f in a)q(U.DUPLICATE_KEYS,f,g,a[f].path);else{const v=ot(p,f,g,d);if(v){const{type:m,options:h,input:w}=v,{onChange:$,transient:y,onEditStart:I,onEditEnd:k}=h,z=_(h,Cn);d[g]=E(E(E({type:m},z),w),{},{fromPanel:!0}),a[f]={path:g,onChange:$,transient:y,onEditStart:I,onEditEnd:k}}else q(U.UNKNOWN_INPUT,g,p)}}),d};this.getDataFromSchema=n=>{const l={};return[c(n,"",l),l]}},je=new Sn,Rn={collapsed:!1};function xn(e,t){return{type:A.FOLDER,schema:e,settings:E(E({},Rn),t)}}const Pn={disabled:!1};function $o(e,t){return{type:A.BUTTON,onClick:e,settings:E(E({},Pn),t)}}const Ee=e=>"__levaInput"in e,kn=(e,t)=>{const o={},r=t?t.toLowerCase():null;return e.forEach(i=>{const[c,n]=xt(i);(!r||c.toLowerCase().indexOf(r)>-1)&&Rt(o,n,{[c]:{__levaInput:!0,path:i}})}),o},Tn=["type","label","path","valueKey","value","settings","setValue","disabled"];function In(e){let{type:t,label:o,path:r,valueKey:i,value:c,settings:n,setValue:l,disabled:a}=e,d=_(e,Tn);const{displayValue:f,onChange:p,onUpdate:g}=Ye({type:t,value:c,settings:n,setValue:l}),v=Ce[t].component;return v?s.createElement(Je.Provider,{value:E({key:i,path:r,id:""+r,label:o,displayValue:f,value:c,onChange:p,onUpdate:g,settings:n,setValue:l,disabled:a},d)},s.createElement(qe,{disabled:a},s.createElement(v,null))):(q(U.NO_COMPONENT_FOR_TYPE,t,r),null)}const On=C("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function zn({onClick:e,settings:t,label:o}){const r=ie();return s.createElement(N,null,s.createElement(On,{disabled:t.disabled,onClick:()=>e(r.get)},o))}const jn=C("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),Ln=C("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),Dn=({label:e,opts:t})=>{let o=typeof e=="string"&&e.trim()===""?null:e,r=t;return typeof t.opts=="object"&&(r.label!==void 0&&(o=t.label),r=t.opts),{label:o,opts:r}};function Mn(e){const{label:t,opts:o}=Dn(e),r=ie();return s.createElement(N,{input:!!t},t&&s.createElement(K,null,t),s.createElement(jn,null,Object.entries(o).map(([i,c])=>s.createElement(Ln,{key:i,onClick:()=>c(r.get)},i))))}const _n=C("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),Le=100;function Fn(e,t){e.push(t),e.length>Le&&e.shift()}const Hn=u.forwardRef(function({initialValue:e},t){const o=V("colors","highlight3"),r=V("colors","elevation2"),i=V("colors","highlight1"),[c,n]=u.useMemo(()=>[X(i).alpha(.4).toRgbString(),X(i).alpha(.1).toRgbString()],[i]),l=u.useRef([e]),a=u.useRef(e),d=u.useRef(e),f=u.useRef(),p=u.useCallback((m,h)=>{if(!m)return;const{width:w,height:$}=m,y=new Path2D,I=w/Le,k=$*.05;for(let P=0;P<l.current.length;P++){const j=ae(l.current[P],a.current,d.current),M=I*P,T=$-j*($-k*2)-k;y.lineTo(M,T)}h.clearRect(0,0,w,$);const z=new Path2D(y);z.lineTo(I*(l.current.length+1),$),z.lineTo(0,$),z.lineTo(0,0);const x=h.createLinearGradient(0,0,0,$);x.addColorStop(0,c),x.addColorStop(1,n),h.fillStyle=x,h.fill(z),h.strokeStyle=r,h.lineJoin="round",h.lineWidth=14,h.stroke(y),h.strokeStyle=o,h.lineWidth=2,h.stroke(y)},[o,r,c,n]),[g,v]=_e(p);return u.useImperativeHandle(t,()=>({frame:m=>{(a.current===void 0||m<a.current)&&(a.current=m),(d.current===void 0||m>d.current)&&(d.current=m),Fn(l.current,m),f.current=requestAnimationFrame(()=>p(g.current,v.current))}}),[g,v,p]),u.useEffect(()=>()=>cancelAnimationFrame(f.current),[]),s.createElement(_n,{ref:g})}),ye=e=>Number.isFinite(e)?e.toPrecision(2):e.toString(),Vn=u.forwardRef(function({initialValue:e},t){const[o,r]=u.useState(ye(e));return u.useImperativeHandle(t,()=>({frame:i=>r(ye(i))}),[]),s.createElement("div",null,o)});function $e(e){return typeof e=="function"?e():e.current}function An({label:e,objectOrFn:t,settings:o}){const r=u.useRef(),i=u.useRef($e(t));return u.useEffect(()=>{const c=window.setInterval(()=>{var n;document.hidden||(n=r.current)===null||n===void 0||n.frame($e(t))},o.interval);return()=>window.clearInterval(c)},[t,o.interval]),s.createElement(N,{input:!0},s.createElement(K,{align:"top"},e),o.graph?s.createElement(Hn,{ref:r,initialValue:i.current}):s.createElement(Vn,{ref:r,initialValue:i.current}))}const Wn=["type","label","key"],Nn={[A.BUTTON]:zn,[A.BUTTON_GROUP]:Mn,[A.MONITOR]:An},Bn=s.memo(({path:e})=>{const[t,{set:o,setSettings:r,disable:i,storeId:c,emitOnEditStart:n,emitOnEditEnd:l}]=Fe(e);if(!t)return null;const{type:a,label:d,key:f}=t,p=_(t,Wn);if(a in A){const g=Nn[a];return s.createElement(g,W({label:d,path:e},p))}return a in Ce?s.createElement(In,W({key:c+e,type:a,label:d,storeId:c,path:e,valueKey:f,setValue:o,setSettings:r,disable:i,emitOnEditStart:n,emitOnEditEnd:l},p)):(He(U.UNSUPPORTED_INPUT,a,e),null)});function Un({toggle:e,toggled:t,name:o}){return s.createElement(rt,{onClick:()=>e()},s.createElement(Re,{toggled:t}),s.createElement("div",null,o))}const Gn=({name:e,path:t,tree:o})=>{const r=ie(),i=fe(t,e),{collapsed:c,color:n}=r.getFolderSettings(i),[l,a]=u.useState(!c),d=u.useRef(null),f=V("colors","folderWidgetColor"),p=V("colors","folderTextColor");return u.useLayoutEffect(()=>{d.current.style.setProperty("--leva-colors-folderWidgetColor",n||f),d.current.style.setProperty("--leva-colors-folderTextColor",n||p)},[n,f,p]),s.createElement(Xe,{ref:d},s.createElement(Un,{name:e,toggled:l,toggle:()=>a(g=>!g)}),s.createElement(De,{parent:i,tree:o,toggled:l}))},De=s.memo(({isRoot:e=!1,fill:t=!1,flat:o=!1,parent:r,tree:i,toggled:c})=>{const{wrapperRef:n,contentRef:l}=Tt(c),a=ie(),d=([p,g])=>{var v;return(Ee(g)?(v=a.getInput(g.path))===null||v===void 0?void 0:v.order:a.getFolderSettings(fe(r,p)).order)||0},f=Object.entries(i).sort((p,g)=>d(p)-d(g));return s.createElement(Ve,{ref:n,isRoot:e,fill:t,flat:o},s.createElement(Ae,{ref:l,isRoot:e,toggled:c},f.map(([p,g])=>Ee(g)?s.createElement(Bn,{key:g.path,valueKey:g.valueKey,path:g.path}):s.createElement(Gn,{key:p,name:p,path:r,tree:g}))))}),Kn=C("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${We}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),Me=40,re=C("i",{$flexCenter:"",width:Me,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),Yn=C("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),Jn=C("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${re}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),qn=C("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),Xn=C("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:Me}}}}),Zn=s.forwardRef(({setFilter:e,toggle:t},o)=>{const[r,i]=u.useState(""),c=u.useMemo(()=>Ne(e,250),[e]),n=()=>{e(""),i("")},l=a=>{const d=a.currentTarget.value;t(!0),i(d)};return u.useEffect(()=>{c(r)},[r,c]),s.createElement(s.Fragment,null,s.createElement(qn,{ref:o,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:a=>a.stopPropagation(),onChange:l}),s.createElement(re,{onClick:()=>n(),style:{visibility:r?"visible":"hidden"}},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},s.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function Qn({setFilter:e,onDrag:t,onDragStart:o,onDragEnd:r,toggle:i,toggled:c,title:n,drag:l,filterEnabled:a,from:d}){const[f,p]=u.useState(!1),g=u.useRef(null);u.useEffect(()=>{var m,h;f?(m=g.current)===null||m===void 0||m.focus():(h=g.current)===null||h===void 0||h.blur()},[f]);const v=ce(({offset:[m,h],first:w,last:$})=>{t({x:m,y:h}),w&&o({x:m,y:h}),$&&r({x:m,y:h})},{filterTaps:!0,from:({offset:[m,h]})=>[(d==null?void 0:d.x)||m,(d==null?void 0:d.y)||h]});return u.useEffect(()=>{const m=h=>{h.key==="L"&&h.shiftKey&&h.metaKey&&p(w=>!w)};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[]),s.createElement(s.Fragment,null,s.createElement(Yn,{mode:l?"drag":void 0},s.createElement(re,{active:!c,onClick:()=>i()},s.createElement(Re,{toggled:c,width:12,height:8})),s.createElement(Xn,W({},l?v():{},{drag:l,filterEnabled:a}),n===void 0&&l?s.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},s.createElement("circle",{cx:"2",cy:"2",r:"2"}),s.createElement("circle",{cx:"14",cy:"2",r:"2"}),s.createElement("circle",{cx:"26",cy:"2",r:"2"}),s.createElement("circle",{cx:"2",cy:"12",r:"2"}),s.createElement("circle",{cx:"14",cy:"12",r:"2"}),s.createElement("circle",{cx:"26",cy:"12",r:"2"})):n),a&&s.createElement(re,{active:f,onClick:()=>p(m=>!m)},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},s.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),s.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),s.createElement(Jn,{toggled:f},s.createElement(Zn,{ref:g,setFilter:e,toggle:i})))}const eo=["store","hidden","theme","collapsed"];function to(e){let{store:t,hidden:o=!1,theme:r,collapsed:i=!1}=e,c=_(e,eo);const n=Pe(()=>st(r),[r]),[l,a]=u.useState(!i),d=typeof i=="object"?!i.collapsed:l,f=u.useMemo(()=>typeof i=="object"?p=>{typeof p=="function"?i.onChange(!p(!i.collapsed)):i.onChange(!p)}:a,[i]);return!t||o?null:s.createElement(it.Provider,{value:n},s.createElement(no,W({store:t},c,{toggled:d,setToggle:f,rootClass:n.className})))}const no=s.memo(({store:e,rootClass:t,fill:o=!1,flat:r=!1,neverHide:i=!1,oneLineLabels:c=!1,titleBar:n={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:l=!1,toggled:a,setToggle:d})=>{var f,p;const g=It(e),[v,m]=u.useState(""),h=u.useMemo(()=>kn(g,v),[g,v]),[w,$]=Se(),y=i||g.length>0,I=typeof n=="object"&&n.title||void 0,k=typeof n=="object"&&(f=n.drag)!==null&&f!==void 0?f:!0,z=typeof n=="object"&&(p=n.filter)!==null&&p!==void 0?p:!0,x=typeof n=="object"&&n.position||void 0,P=typeof n=="object"&&n.onDrag||void 0,j=typeof n=="object"&&n.onDragStart||void 0,M=typeof n=="object"&&n.onDragEnd||void 0;return s.useEffect(()=>{$({x:x==null?void 0:x.x,y:x==null?void 0:x.y})},[x,$]),Be(),s.createElement(Ue.Provider,{value:{hideCopyButton:l}},s.createElement(Kn,{ref:w,className:t,fill:o,flat:r,oneLineLabels:c,hideTitleBar:!n,style:{display:y?"block":"none"}},n&&s.createElement(Qn,{onDrag:T=>{$(T),P==null||P(T)},onDragStart:T=>j==null?void 0:j(T),onDragEnd:T=>M==null?void 0:M(T),setFilter:m,toggle:T=>d(S=>T??!S),toggled:a,title:I,drag:k,filterEnabled:z,from:x}),y&&s.createElement(Ge.Provider,{value:e},s.createElement(De,{isRoot:!0,fill:o,flat:r,tree:h,toggled:a}))))}),oo=["isRoot"];let se=!1,G=null;function ro(e){let{isRoot:t=!1}=e,o=_(e,oo);return u.useEffect(()=>(se=!0,!t&&G&&(G.remove(),G=null),()=>{t||(se=!1)}),[t]),s.createElement(to,W({store:je},o))}function so(e){u.useEffect(()=>{e&&!se&&(G||(G=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(G),at(s.createElement(ro,{isRoot:!0}),G))),se=!0)},[e])}function io(e,t,o,r,i){let c,n,l,a,d;return typeof e=="string"?(n=e,c=t,Array.isArray(o)&&(d=o)):(c=e,Array.isArray(t)?d=t:(a=t,d=o)),{schema:c,folderName:n,folderSettings:l,hookSettings:a,deps:d||[]}}function wo(e,t,o,r,i){const{folderName:c,schema:n,folderSettings:l,hookSettings:a,deps:d}=io(e,t,o),f=typeof n=="function",p=u.useRef(!1),g=u.useRef(!0),v=Pe(()=>{p.current=!0;const S=typeof n=="function"?n():n;return c?{[c]:xn(S,l)}:S},d),m=!(a!=null&&a.store);so(m);const[h]=u.useState(()=>(a==null?void 0:a.store)||je),[w,$]=u.useMemo(()=>h.getDataFromSchema(v),[h,v]),[y,I,k,z,x]=u.useMemo(()=>{const S=[],b=[],R={},L={},D={};return Object.values($).forEach(({path:O,onChange:B,onEditStart:Y,onEditEnd:J,transient:te})=>{S.push(O),B?(R[O]=B,te||b.push(O)):b.push(O),Y&&(L[O]=Y),J&&(D[O]=J)}),[S,b,R,L,D]},[$]),P=u.useMemo(()=>h.orderPaths(y),[y,h]),j=Ot(h,I,w),M=u.useCallback(S=>{const b=Object.entries(S).reduce((R,[L,D])=>Object.assign(R,{[$[L].path]:D}),{});h.set(b,!1)},[h,$]),T=u.useCallback(S=>h.get($[S].path),[h,$]);return u.useEffect(()=>{const S=!g.current&&p.current;return h.addData(w,S),g.current=!1,p.current=!1,()=>h.disposePaths(P)},[h,P,w]),u.useEffect(()=>{const S=[];return Object.entries(k).forEach(([b,R])=>{R(h.get(b),b,E({initial:!0,get:h.get},h.getInput(b)));const L=h.useStore.subscribe(D=>{const O=D.data[b];return[O.disabled?void 0:O.value,O]},([D,O])=>R(D,b,E({initial:!1,get:h.get},O)),{equalityFn:de});S.push(L)}),()=>S.forEach(b=>b())},[h,k]),u.useEffect(()=>{const S=[];return Object.entries(z).forEach(([b,R])=>S.push(h.subscribeToEditStart(b,R))),Object.entries(x).forEach(([b,R])=>S.push(h.subscribeToEditEnd(b,R))),()=>S.forEach(b=>b())},[z,x,h]),f?[j,M,T]:j}F(H.SELECT,Ze);F(H.IMAGE,dn);F(H.NUMBER,Qe);F(H.COLOR,Wt);F(H.STRING,et);F(H.BOOLEAN,tt);F(H.INTERVAL,yn);F(H.VECTOR3D,Bt);F(H.VECTOR2D,Zt);export{ro as L,$o as b,wo as u};
